var __extends=this&&this.__extends||function(e,r){function t(){this.constructor=e}for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)},webcrypto;!function(e){function r(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(var o=e,a=/[^%](%\d+)/g,n=null,i=[];n=a.exec(o);)i.push({arg:n[1],index:n.index});for(var s=i.length-1;s>=0;s--){var c=i[s],h=c.arg.substring(1),p=c.index+1;o=o.substring(0,p)+arguments[+h]+o.substring(p+1+h.length)}return o=o.replace("%%","%")}var t=function(e){function t(t){for(var o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];e.call(this),this.code=0,this.message=r.apply(void 0,[t].concat(o));var n=new Error(this.message);n.name=this.constructor.name,this.stack=n.stack}return __extends(t,e),t.NOT_SUPPORTED="Method is not supported",t}(Error);e.WebCryptoError=t;var o=function(e){function r(){e.apply(this,arguments),this.code=1}return __extends(r,e),r.PARAM_REQUIRED="Algorithm hasn't got required paramter '%1'",r.PARAM_WRONG_TYPE="Algorithm has got wrong type for paramter '%1'. Must be %2",r.PARAM_WRONG_VALUE="Algorithm has got wrong value for paramter '%1'. Must be %2",r.WRONG_ALG_NAME="Algorithm has got wrong name '%1'. Must be '%2'",r.UNSUPPORTED_ALGORITHM="Algorithm '%1' is not supported",r}(t);e.AlgorithmError=o;var a=function(e){function r(){e.apply(this,arguments),this.code=3}return __extends(r,e),r.EMPTY_KEY="CryptoKey is empty",r.WRONG_KEY_ALG="CryptoKey has wrong algorithm '%1'. Must be '%2'",r.WRONG_KEY_TYPE="CryptoKey has wrong type '%1'. Must be '%2'",r.WRONG_KEY_USAGE="CryptoKey has wrong key usage. Must be '%1'",r.NOT_EXTRACTABLE="CryptoKey is not extractable",r.WRONG_FORMAT="CryptoKey has '%1' type. It can be used with '%2' format",r.UNKNOWN_FORMAT="Uknown format in use '%1'. Must be one of 'raw', 'pkcs8', 'spki'  or 'jwk'",r.ALLOWED_FORMAT="Wrong format value '%1'. Must be %2",r}(t);e.CryptoKeyError=a}(webcrypto||(webcrypto={}));var webcrypto;!function(e){e.AlgorithmNames={RsaSSA:"RSASSA-PKCS1-v1_5",RsaPSS:"RSA-PSS",RsaOAEP:"RSA-OAEP",AesCTR:"AES-CTR",AesCMAC:"AES-CMAC",AesGCM:"AES-GCM",AesCBC:"AES-CBC",Sha1:"SHA-1",Sha256:"SHA-256",Sha384:"SHA-384",Sha512:"SHA-512",EcDSA:"ECDSA",EcDH:"ECDH"}}(webcrypto||(webcrypto={}));var webcrypto;!function(e){function r(e){var r;return r="string"==typeof e?{name:e}:e,o.checkAlgorithm(r),r}function t(r,t){if(!r)throw new e.WebCryptoError("Parameter '"+t+"' is required and cant be empty");if(ArrayBuffer.isView(r)||r instanceof ArrayBuffer)return new Uint8Array(r);throw new e.WebCryptoError("Incoming parameter '"+t+"' has wrong data type. Must be ArrayBufferView or ArrayBuffer")}e.PrepareAlgorithm=r,e.PrepareData=t;var o=function(){function r(){}return r.checkAlgorithm=function(r){if("object"!=typeof r)throw new TypeError("Wrong algorithm data type. Must be Object");if(!("name"in r))throw new e.AlgorithmError(e.AlgorithmError.PARAM_REQUIRED,"name");if("string"!=typeof r.name)throw new e.AlgorithmError(e.AlgorithmError.PARAM_WRONG_VALUE,"name","String")},r.checkAlgorithmParams=function(e){this.checkAlgorithm(e)},r.checkKey=function(r,t,o,a){if(void 0===o&&(o=null),void 0===a&&(a=null),!r)throw new e.CryptoKeyError(e.CryptoKeyError.EMPTY_KEY);var n=r.algorithm;if(t&&(!n||n.name.toUpperCase()!==t.toUpperCase()))throw new e.CryptoKeyError(e.CryptoKeyError.WRONG_KEY_ALG,n.name,t);if(o&&(!r.type||r.type.toUpperCase()!==o.toUpperCase()))throw new e.CryptoKeyError(e.CryptoKeyError.WRONG_KEY_TYPE,r.type,o);if(a){for(var i=0,s=r.usages;i<s.length;i++){var c=s[i];if(a.toUpperCase()===c.toUpperCase())return}throw new e.CryptoKeyError(e.CryptoKeyError.WRONG_KEY_USAGE,a)}},r.checkWrappedKey=function(r){if("public"!==r.type&&!r.extractable)throw new e.CryptoKeyError(e.CryptoKeyError.NOT_EXTRACTABLE)},r.checkKeyUsages=function(r){if(!r||!r.length)throw new e.WebCryptoError("Parameter 'keyUsages' cannot be empty.")},r.checkFormat=function(r,t){switch(r.toLowerCase()){case"raw":if(t&&"secret"!==t.toLowerCase())throw new e.CryptoKeyError(e.CryptoKeyError.WRONG_FORMAT,t,"raw");break;case"pkcs8":if(t&&"private"!==t.toLowerCase())throw new e.CryptoKeyError(e.CryptoKeyError.WRONG_FORMAT,t,"pkcs8");break;case"spki":if(t&&"public"!==t.toLowerCase())throw new e.CryptoKeyError(e.CryptoKeyError.WRONG_FORMAT,t,"spki");break;case"jwk":break;default:throw new e.CryptoKeyError(e.CryptoKeyError.UNKNOWN_FORMAT,r)}},r.checkFormatImport=function(e,r){this.checkFormat(e)},r.generateKey=function(){return new Promise(function(){throw new e.WebCryptoError(e.WebCryptoError.NOT_SUPPORTED)})},r.digest=function(){return new Promise(function(){throw new e.WebCryptoError(e.WebCryptoError.NOT_SUPPORTED)})},r.sign=function(){return new Promise(function(){throw new e.WebCryptoError(e.WebCryptoError.NOT_SUPPORTED)})},r.verify=function(){return new Promise(function(){throw new e.WebCryptoError(e.WebCryptoError.NOT_SUPPORTED)})},r.encrypt=function(){return new Promise(function(){throw new e.WebCryptoError(e.WebCryptoError.NOT_SUPPORTED)})},r.decrypt=function(){return new Promise(function(){throw new e.WebCryptoError(e.WebCryptoError.NOT_SUPPORTED)})},r.deriveBits=function(){return new Promise(function(){throw new e.WebCryptoError(e.WebCryptoError.NOT_SUPPORTED)})},r.deriveKey=function(){return new Promise(function(){throw new e.WebCryptoError(e.WebCryptoError.NOT_SUPPORTED)})},r.exportKey=function(){return new Promise(function(){throw new e.WebCryptoError(e.WebCryptoError.NOT_SUPPORTED)})},r.importKey=function(){return new Promise(function(){throw new e.WebCryptoError(e.WebCryptoError.NOT_SUPPORTED)})},r.wrapKey=function(){return new Promise(function(){throw new e.WebCryptoError(e.WebCryptoError.NOT_SUPPORTED)})},r.unwrapKey=function(){return new Promise(function(){throw new e.WebCryptoError(e.WebCryptoError.NOT_SUPPORTED)})},r}();e.BaseCrypto=o}(webcrypto||(webcrypto={})),"undefined"!=typeof module&&(module.exports=webcrypto);var webcrypto;!function(e){var r=function(){function e(){}return e.buffer2string=function(e){for(var r="",t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return r},e.string2buffer=function(e){for(var r=new Uint8Array(e.length),t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r},e.encode=function(e){var r=this.buffer2string(e),t=btoa(r).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");return t},e.decode=function(e){for(;e.length%4;)e+="=";var r=e.replace(/\-/g,"+").replace(/_/g,"/");return this.string2buffer(atob(r))},e}();e.Base64Url=r}(webcrypto||(webcrypto={}));var webcrypto;!function(e){var r;!function(r){var t=function(e){function r(){e.apply(this,arguments),this.code=2}return __extends(r,e),r}(e.AlgorithmError);r.RsaKeyGenParamsError=t;var o=[e.AlgorithmNames.Sha1,e.AlgorithmNames.Sha256,e.AlgorithmNames.Sha384,e.AlgorithmNames.Sha512].join(" | "),a=function(r){function t(){r.apply(this,arguments)}return __extends(t,r),t.checkAlgorithm=function(t){switch(r.checkAlgorithm.call(this,t),t.name.toUpperCase()){case e.AlgorithmNames.Sha1:case e.AlgorithmNames.Sha256:case e.AlgorithmNames.Sha384:case e.AlgorithmNames.Sha512:break;default:throw new e.AlgorithmError(e.AlgorithmError.WRONG_ALG_NAME,t.name,o)}},t.digest=function(e){var r=this;return new Promise(function(t){r.checkAlgorithm(e),t(null)})},t}(e.BaseCrypto);r.Sha=a;var n=function(e){function r(){e.apply(this,arguments),this.code=6}return __extends(r,e),r}(e.AlgorithmError);r.RsaHashedImportParamsError=n;var i=function(r){function i(){r.apply(this,arguments)}return __extends(i,r),i.checkAlgorithm=function(r){if(r.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new e.AlgorithmError(e.AlgorithmError.WRONG_ALG_NAME,r.name,this.ALG_NAME)},i.checkImportAlgorithm=function(e){if(this.checkAlgorithm(e),!e.hash)throw new n(n.PARAM_REQUIRED,"hash");a.checkAlgorithm(e.hash)},i.checkKeyGenParams=function(e){switch(e.modulusLength){case 1024:case 2048:case 4096:break;default:throw new t(t.PARAM_WRONG_VALUE,"modulusLength","1024, 2048 or 4096")}var r=e.publicExponent;if(!r)throw new t(t.PARAM_REQUIRED,"publicExponent");if(!ArrayBuffer.isView(r))throw new t(t.PARAM_WRONG_TYPE,"publicExponent","ArrayBufferView");if(3!==r[0]&&(1!==r[0]||0!==r[1]||1!==r[2]))throw new t(t.PARAM_WRONG_VALUE,"publicExponent","Uint8Array([3]) | Uint8Array([1, 0, 1])");if(!e.hash)throw new t(t.PARAM_REQUIRED,"hash",o);a.checkAlgorithm(e.hash)},i.checkKeyGenUsages=function(r){this.checkKeyUsages(r);for(var t=0,o=r;t<o.length;t++){var a=o[t],n=0;for(n;n<this.KEY_USAGES.length&&this.KEY_USAGES[n].toLowerCase()!==a.toLowerCase();n++);if(n===this.KEY_USAGES.length)throw new e.WebCryptoError("Unsuported key usage '"+a+"'. Should be one of ["+this.KEY_USAGES.join(", ")+"]")}},i.generateKey=function(e,r,t){var o=this;return new Promise(function(r){o.checkAlgorithm(e),o.checkKeyGenParams(e),o.checkKeyGenUsages(t),r(null)})},i.exportKey=function(e,r){var t=this;return new Promise(function(o){t.checkKey(r,t.ALG_NAME),t.checkFormat(e,r.type),o(null)})},i.importKey=function(r,t,o,a,n){var i=this;return new Promise(function(t){if(i.checkImportAlgorithm(o),i.checkFormat(r),"raw"===r.toLowerCase())throw new e.CryptoKeyError(e.CryptoKeyError.ALLOWED_FORMAT,r,"'jwk', 'pkcs8' or 'spki'");i.checkKeyGenUsages(n),t(null)})},i.ALG_NAME="",i.KEY_USAGES=[],i}(e.BaseCrypto);r.Rsa=i;var s=function(r){function t(){r.apply(this,arguments)}return __extends(t,r),t.sign=function(e,r){var t=this;return new Promise(function(o){t.checkAlgorithmParams(e),t.checkKey(r,t.ALG_NAME,"private","sign"),o(null)})},t.verify=function(e,r){var t=this;return new Promise(function(o){t.checkAlgorithmParams(e),t.checkKey(r,t.ALG_NAME,"public","verify"),o(null)})},t.ALG_NAME=e.AlgorithmNames.RsaSSA,t.KEY_USAGES=["sign","verify"],t}(i);r.RsaSSA=s;var c=function(e){function r(){e.apply(this,arguments),this.code=4}return __extends(r,e),r}(e.AlgorithmError);r.RsaPSSParamsError=c;var h=function(r){function t(){r.apply(this,arguments)}return __extends(t,r),t.checkAlgorithmParams=function(e){return e.saltLength?e.saltLength%8?new c("Parameter 'saltLength' should be a multiple of 8"):void 0:new c(c.PARAM_REQUIRED,"saltLength")},t.ALG_NAME=e.AlgorithmNames.RsaPSS,t.KEY_USAGES=["sign","verify"],t}(s);r.RsaPSS=h;var p=function(e){function r(){e.apply(this,arguments),this.code=5}return __extends(r,e),r}(e.AlgorithmError);r.RsaOAEPParamsError=p;var A=function(r){function t(){r.apply(this,arguments)}return __extends(t,r),t.checkAlgorithmParams=function(e){return e.label&&!ArrayBuffer.isView(e.label)?new p(p.PARAM_WRONG_TYPE,"label","ArrayBufferView"):void 0},t.encrypt=function(e,r){var t=this;return new Promise(function(o){t.checkAlgorithmParams(e),t.checkKey(r,t.ALG_NAME,"public","encrypt"),o(null)})},t.decrypt=function(e,r){var t=this;return new Promise(function(o){t.checkAlgorithmParams(e),t.checkKey(r,t.ALG_NAME,"private","decrypt"),o(null)})},t.wrapKey=function(e,r,t,o){var a=this;return new Promise(function(n){a.checkAlgorithmParams(o),a.checkKey(t,a.ALG_NAME,"public","wrapKey"),a.checkWrappedKey(r),a.checkFormat(e,r.type),n(null)})},t.unwrapKey=function(e,r,t,o){var a=this;return new Promise(function(r){a.checkAlgorithmParams(o),a.checkKey(t,a.ALG_NAME,"private","unwrapKey"),a.checkFormat(e),r(null)})},t.ALG_NAME=e.AlgorithmNames.RsaOAEP,t.KEY_USAGES=["encrypt","decrypt","wrapKey","unwrapKey"],t}(i);r.RsaOAEP=A}(r=e.rsa||(e.rsa={}))}(webcrypto||(webcrypto={}));var webcrypto;!function(e){var r;!function(){}(r=e.aes||(e.aes={}))}(webcrypto||(webcrypto={}));var webcrypto;!function(e){var r;!function(r){var t=function(e){function r(){e.apply(this,arguments),this.code=7}return __extends(r,e),r}(e.AlgorithmError),o=function(r){function o(){r.apply(this,arguments)}return __extends(o,r),o.checkAlgorithm=function(r){if(r.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new e.AlgorithmError(e.AlgorithmError.WRONG_ALG_NAME,r.name,this.ALG_NAME)},o.checkKeyGenParams=function(e){switch(e.length){case 128:case 192:case 256:break;default:throw new t(t.PARAM_WRONG_VALUE,"length","128, 192 or 256")}},o.checkKeyGenUsages=function(r){this.checkKeyUsages(r);for(var t=0,o=r;t<o.length;t++){var a=o[t],n=0;for(n;n<this.KEY_USAGES.length&&this.KEY_USAGES[n].toLowerCase()!==a.toLowerCase();n++);if(n===this.KEY_USAGES.length)throw new e.WebCryptoError("Unsuported key usage '"+a+"'. Should be one of ["+this.KEY_USAGES.join(", ")+"]")}},o.generateKey=function(e,r,t){var o=this;return new Promise(function(r){o.checkAlgorithm(e),o.checkKeyGenParams(e),o.checkKeyGenUsages(t),r(null)})},o.exportKey=function(e,r){var t=this;return new Promise(function(o){t.checkKey(r,t.ALG_NAME),t.checkFormat(e,r.type),o(null)})},o.importKey=function(r,t,o,a,n){var i=this;return new Promise(function(t){if(i.checkAlgorithm(o),i.checkFormat(r),"raw"!==r.toLowerCase()&&"jwk"!==r.toLowerCase())throw new e.CryptoKeyError(e.CryptoKeyError.ALLOWED_FORMAT,r,"'jwk' or 'raw'");i.checkKeyGenUsages(n),t(null)})},o.ALG_NAME="",o.KEY_USAGES=[],o}(e.BaseCrypto);r.Aes=o;var a=function(e){function r(){e.apply(this,arguments),this.code=8}return __extends(r,e),r}(e.AlgorithmError);r.AesAlgorithmError=a;var n=function(e){function r(){e.apply(this,arguments)}return __extends(r,e),r.encrypt=function(e,r){var t=this;return new Promise(function(o){t.checkAlgorithmParams(e),t.checkKey(r,t.ALG_NAME,"secret","encrypt"),o(null)})},r.decrypt=function(e,r){var t=this;return new Promise(function(o){t.checkAlgorithmParams(e),t.checkKey(r,t.ALG_NAME,"secret","decrypt"),o(null)})},r.wrapKey=function(e,r,t,o){var a=this;return new Promise(function(n){a.checkAlgorithmParams(o),a.checkKey(t,a.ALG_NAME,"secret","wrapKey"),a.checkWrappedKey(r),a.checkFormat(e,r.type),n(null)})},r.unwrapKey=function(e,r,t,o){var a=this;return new Promise(function(r){a.checkAlgorithmParams(o),a.checkKey(t,a.ALG_NAME,"secret","unwrapKey"),a.checkFormat(e),r(null)})},r.KEY_USAGES=["encrypt","decrypt","wrapKey","unwrapKey"],r}(o);r.AesEncrypt=n;var i=function(r){function t(){r.apply(this,arguments)}return __extends(t,r),t.checkAlgorithmParams=function(e){if(this.checkAlgorithm(e),!e.iv)throw new a(a.PARAM_REQUIRED,"iv");if(!ArrayBuffer.isView(e.iv))throw new a(a.PARAM_WRONG_TYPE,"iv","ArrayBufferView");if(16!==e.iv.byteLength)throw new a(a.PARAM_WRONG_VALUE,"iv","ArrayBufferView with size 16")},t.ALG_NAME=e.AlgorithmNames.AesCBC,t}(n);r.AesCBC=i;var s=function(r){function t(){r.apply(this,arguments)}return __extends(t,r),t.checkAlgorithmParams=function(e){if(this.checkAlgorithm(e),!e.counter||!ArrayBuffer.isView(e.counter))throw new a(a.PARAM_WRONG_TYPE,"counter","ArrayBufferView");if(16!==e.counter.byteLength)throw new a(a.PARAM_WRONG_VALUE,"counter","ArrayBufferView with size 16");if(!(e.length>0&&e.length<=128))throw new a(a.PARAM_WRONG_VALUE,"length","number [1-128]")},t.ALG_NAME=e.AlgorithmNames.AesCTR,t}(n);r.AesCTR=s;var c=function(r){function t(){r.apply(this,arguments)}return __extends(t,r),t.checkAlgorithmParams=function(e){if(this.checkAlgorithm(e),e.additionalData&&!ArrayBuffer.isView(e.additionalData))throw new a(a.PARAM_WRONG_TYPE,"additionalData","ArrayBufferView");if(!e.iv)throw new a(a.PARAM_REQUIRED,"iv");if(!ArrayBuffer.isView(e.iv))throw new a(a.PARAM_WRONG_TYPE,"iv","ArrayBufferView");if(e.tagLength&&!(e.tagLength>=0&&e.tagLength<=128))throw new a(a.PARAM_WRONG_VALUE,"tagLength","number [0-128]")},t.ALG_NAME=e.AlgorithmNames.AesGCM,t}(n);r.AesGCM=c}(r=e.aes||(e.aes={}))}(webcrypto||(webcrypto={}));var webcrypto;!function(e){var r;!function(r){var t=e.aes.AesCBC,o=e.aes.AesCTR,a=e.aes.AesGCM,n=e.rsa.Sha,i=function(e){function r(){e.apply(this,arguments),this.code=9}return __extends(r,e),r}(e.AlgorithmError);r.EcKeyGenParamsError=i;var s=function(r){function t(){r.apply(this,arguments)}return __extends(t,r),t.checkAlgorithm=function(r){if(r.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new e.AlgorithmError(e.AlgorithmError.WRONG_ALG_NAME,r.name,this.ALG_NAME)},t.checkKeyGenParams=function(e){var r="namedCurve";if(!e.namedCurve)throw new i(i.PARAM_REQUIRED,r);if("string"!=typeof e.namedCurve)throw new i(i.PARAM_WRONG_TYPE,r,"string");switch(e.namedCurve.toUpperCase()){case"P-256":case"P-384":case"P-521":break;default:throw new i(i.PARAM_WRONG_VALUE,r,"P-256, P-384 or P-521")}},t.checkKeyGenUsages=function(r){for(var t=0,o=r;t<o.length;t++){var a=o[t],n=0;for(n;n<this.KEY_USAGES.length&&this.KEY_USAGES[n].toLowerCase()!==a.toLowerCase();n++);if(n===this.KEY_USAGES.length)throw new e.WebCryptoError("Unsuported key usage '"+a+"'. Should be one of ["+this.KEY_USAGES.join(", ")+"]")}},t.generateKey=function(e,r,t){var o=this;return new Promise(function(r){o.checkAlgorithm(e),o.checkKeyGenParams(e),o.checkKeyGenUsages(t),r(null)})},t.exportKey=function(e,r){var t=this;return new Promise(function(o){t.checkKey(r,t.ALG_NAME),t.checkFormat(e,r.type),o(null)})},t.importKey=function(r,t,o,a,n){var i=this;return new Promise(function(t){if(i.checkKeyGenParams(o),i.checkFormat(r),"raw"===r.toLowerCase())throw new e.CryptoKeyError(e.CryptoKeyError.ALLOWED_FORMAT,r,"'jwk', 'pkcs8' or 'spki'");i.checkKeyGenUsages(n),t(null)})},t.ALG_NAME="",t.KEY_USAGES=[],t}(e.BaseCrypto);r.Ec=s;var c=function(e){function r(){e.apply(this,arguments),this.code=10}return __extends(r,e),r}(e.AlgorithmError);r.EcAlgorithmError=c;var h=function(r){function t(){r.apply(this,arguments)}return __extends(t,r),t.checkAlgorithmParams=function(e){this.checkAlgorithm(e),n.checkAlgorithm(e.hash)},t.sign=function(e,r){var t=this;return new Promise(function(o){t.checkAlgorithmParams(e),t.checkKey(r,t.ALG_NAME,"private","sign"),o(null)})},t.verify=function(e,r){var t=this;return new Promise(function(o){t.checkAlgorithmParams(e),t.checkKey(r,t.ALG_NAME,"public","verify"),o(null)})},t.ALG_NAME=e.AlgorithmNames.EcDSA,t.KEY_USAGES=["sign","verify","deriveKey","deriveBits"],t}(s);r.EcDSA=h;var p=function(r){function n(){r.apply(this,arguments)}return __extends(n,r),n.checkDeriveParams=function(e){var r="public";if(this.checkAlgorithm(e),!e["public"])throw new c(c.PARAM_REQUIRED,r);this.checkKey(e["public"],this.ALG_NAME,"public")},n.deriveBits=function(e,r){var t=this;return new Promise(function(o){t.checkDeriveParams(e),t.checkKey(r,t.ALG_NAME,"private","deriveBits"),o(null)})},n.deriveKey=function(r,n,i){var s=this;return new Promise(function(h){switch(s.checkDeriveParams(r),s.checkKey(n,s.ALG_NAME,"private","deriveKey"),e.BaseCrypto.checkAlgorithm(i),i.name.toUpperCase()){case e.AlgorithmNames.AesCBC:t.checkKeyGenParams(i);break;case e.AlgorithmNames.AesCTR:o.checkKeyGenParams(i);break;case e.AlgorithmNames.AesGCM:a.checkKeyGenParams(i);break;default:throw new c("Unsupported name '"+i.name+"' for algoritm in param 'derivedKeyType'")}h(null)})},n.ALG_NAME=e.AlgorithmNames.EcDH,n.KEY_USAGES=["deriveKey","deriveBits"],n}(s);r.EcDH=p}(r=e.ec||(e.ec={}))}(webcrypto||(webcrypto={}));var webcrypto;!function(e){var r=e.rsa.RsaOAEP,t=e.rsa.RsaPSS,o=e.rsa.RsaSSA,a=e.rsa.Sha,n=e.aes.AesCBC,i=e.aes.AesCTR,s=e.aes.AesGCM,c=e.ec.EcDH,h=e.ec.EcDSA,p=function(){function p(){}return p.prototype.generateKey=function(a,p,A){return new Promise(function(m,u){var l=e.PrepareAlgorithm(a),y=e.BaseCrypto;switch(l.name.toUpperCase()){case e.AlgorithmNames.RsaSSA.toUpperCase():y=o;break;case e.AlgorithmNames.RsaOAEP.toUpperCase():y=r;break;case e.AlgorithmNames.RsaPSS.toUpperCase():y=t;break;case e.AlgorithmNames.AesCBC.toUpperCase():y=n;break;case e.AlgorithmNames.AesCTR.toUpperCase():y=i;break;case e.AlgorithmNames.AesGCM.toUpperCase():y=s;break;case e.AlgorithmNames.EcDSA.toUpperCase():y=h;break;case e.AlgorithmNames.EcDH.toUpperCase():y=c;break;default:throw new e.AlgorithmError(e.AlgorithmError.UNSUPPORTED_ALGORITHM,l.name)}y.generateKey(l,p,A).then(m,u)})},p.prototype.digest=function(r,t){return new Promise(function(o,n){var i=e.PrepareAlgorithm(r),s=e.PrepareData(t,"data"),c=e.BaseCrypto;switch(i.name.toUpperCase()){case e.AlgorithmNames.Sha1.toUpperCase():case e.AlgorithmNames.Sha256.toUpperCase():case e.AlgorithmNames.Sha384.toUpperCase():case e.AlgorithmNames.Sha512.toUpperCase():c=a;break;default:throw new e.AlgorithmError(e.AlgorithmError.UNSUPPORTED_ALGORITHM,i.name)}c.digest(i,s).then(o,n)})},p.prototype.sign=function(r,a,n){return new Promise(function(i,s){var c=e.PrepareAlgorithm(r),p=e.PrepareData(n,"data"),A=e.BaseCrypto;switch(c.name.toUpperCase()){case e.AlgorithmNames.RsaSSA.toUpperCase():A=o;break;case e.AlgorithmNames.RsaPSS.toUpperCase():A=t;break;case e.AlgorithmNames.EcDSA.toUpperCase():A=h;break;default:throw new e.AlgorithmError(e.AlgorithmError.UNSUPPORTED_ALGORITHM,c.name)}A.sign(c,a,p).then(i,s)})},p.prototype.verify=function(r,a,n,i){return new Promise(function(n,s){var c=e.PrepareAlgorithm(r),p=e.PrepareData(i,"signature"),A=e.PrepareData(i,"data"),m=e.BaseCrypto;switch(c.name.toUpperCase()){case e.AlgorithmNames.RsaSSA.toUpperCase():m=o;break;case e.AlgorithmNames.RsaPSS.toUpperCase():m=t;break;case e.AlgorithmNames.EcDSA.toUpperCase():m=h;break;default:throw new e.AlgorithmError(e.AlgorithmError.UNSUPPORTED_ALGORITHM,c.name)}m.verify(c,a,p,A).then(n,s)})},p.prototype.encrypt=function(t,o,a){return new Promise(function(c,h){var p=e.PrepareAlgorithm(t),A=e.PrepareData(a,"data"),m=e.BaseCrypto;switch(p.name.toUpperCase()){case e.AlgorithmNames.RsaOAEP.toUpperCase():m=r;break;case e.AlgorithmNames.AesCBC.toUpperCase():m=n;break;case e.AlgorithmNames.AesCTR.toUpperCase():m=i;break;case e.AlgorithmNames.AesGCM.toUpperCase():m=s;break;default:throw new e.AlgorithmError(e.AlgorithmError.UNSUPPORTED_ALGORITHM,p.name)}m.encrypt(p,o,A).then(c,h)})},p.prototype.decrypt=function(t,o,a){return new Promise(function(c,h){var p=e.PrepareAlgorithm(t),A=e.PrepareData(a,"data"),m=e.BaseCrypto;switch(p.name.toUpperCase()){case e.AlgorithmNames.RsaOAEP.toUpperCase():m=r;break;case e.AlgorithmNames.AesCBC.toUpperCase():m=n;break;case e.AlgorithmNames.AesCTR.toUpperCase():m=i;break;case e.AlgorithmNames.AesGCM.toUpperCase():m=s;break;default:throw new e.AlgorithmError(e.AlgorithmError.UNSUPPORTED_ALGORITHM,p.name)}m.decrypt(p,o,A).then(c,h)})},p.prototype.deriveBits=function(r,t,o){return new Promise(function(a,n){var i=e.PrepareAlgorithm(r),s=e.BaseCrypto;switch(i.name.toUpperCase()){case e.AlgorithmNames.EcDH.toUpperCase():s=c;break;default:throw new e.AlgorithmError(e.AlgorithmError.UNSUPPORTED_ALGORITHM,i.name)}s.deriveBits(i,t,o).then(a,n)})},p.prototype.deriveKey=function(r,t,o,a,n){return new Promise(function(i,s){var h=e.PrepareAlgorithm(r),p=e.PrepareAlgorithm(o),A=e.BaseCrypto;switch(h.name.toUpperCase()){case e.AlgorithmNames.EcDH.toUpperCase():A=c;break;default:throw new e.AlgorithmError(e.AlgorithmError.UNSUPPORTED_ALGORITHM,h.name)}A.deriveKey(h,t,p,a,n).then(i,s)})},p.prototype.exportKey=function(a,p){return new Promise(function(A,m){if(e.BaseCrypto.checkKey(p),"public"===p.type&&!p.extractable)throw new e.CryptoKeyError(e.CryptoKeyError.NOT_EXTRACTABLE);var u=e.BaseCrypto;switch(p.algorithm.name.toUpperCase()){case e.AlgorithmNames.RsaSSA.toUpperCase():u=o;break;case e.AlgorithmNames.RsaPSS.toUpperCase():u=t;break;case e.AlgorithmNames.RsaOAEP.toUpperCase():u=r;break;case e.AlgorithmNames.AesCBC.toUpperCase():u=n;break;case e.AlgorithmNames.AesCTR.toUpperCase():u=i;break;case e.AlgorithmNames.AesGCM.toUpperCase():u=s;break;case e.AlgorithmNames.EcDSA.toUpperCase():u=h;break;case e.AlgorithmNames.EcDH.toUpperCase():u=c;break;default:throw new e.AlgorithmError(e.AlgorithmError.UNSUPPORTED_ALGORITHM,p.algorithm.name)}u.exportKey(a,p).then(A,m)})},p.prototype.importKey=function(a,p,A,m,u){return new Promise(function(l,y){var f=e.PrepareAlgorithm(A),g=e.BaseCrypto;switch(f.name.toUpperCase()){case e.AlgorithmNames.RsaSSA.toUpperCase():g=o;break;case e.AlgorithmNames.RsaPSS.toUpperCase():g=t;break;case e.AlgorithmNames.RsaOAEP.toUpperCase():g=r;break;case e.AlgorithmNames.AesCBC.toUpperCase():g=n;break;case e.AlgorithmNames.AesCTR.toUpperCase():g=i;break;case e.AlgorithmNames.AesGCM.toUpperCase():g=s;break;case e.AlgorithmNames.EcDSA.toUpperCase():g=h;break;case e.AlgorithmNames.EcDH.toUpperCase():g=c;break;default:throw new e.AlgorithmError(e.AlgorithmError.UNSUPPORTED_ALGORITHM,f.name)}g.importKey(a,p,f,m,u).then(l,y)})},p.prototype.wrapKey=function(t,o,a,c){return new Promise(function(h,p){var A=e.PrepareAlgorithm(c),m=e.BaseCrypto;switch(A.name.toUpperCase()){case e.AlgorithmNames.RsaOAEP.toUpperCase():m=r;break;case e.AlgorithmNames.AesCBC.toUpperCase():m=n;break;case e.AlgorithmNames.AesCTR.toUpperCase():m=i;break;case e.AlgorithmNames.AesGCM.toUpperCase():m=s;break;default:throw new e.AlgorithmError(e.AlgorithmError.UNSUPPORTED_ALGORITHM,A.name)}m.wrapKey(t,o,a,A).then(h,p)})},p.prototype.unwrapKey=function(t,o,a,c,h,p,A){return new Promise(function(m,u){var l=e.PrepareAlgorithm(c),y=e.PrepareAlgorithm(h),f=e.PrepareData(o,"wrappedKey"),g=e.BaseCrypto;switch(l.name.toUpperCase()){case e.AlgorithmNames.RsaOAEP.toUpperCase():g=r;break;case e.AlgorithmNames.AesCBC.toUpperCase():g=n;break;case e.AlgorithmNames.AesCTR.toUpperCase():g=i;break;case e.AlgorithmNames.AesGCM.toUpperCase():g=s;break;default:throw new e.AlgorithmError(e.AlgorithmError.UNSUPPORTED_ALGORITHM,l.name)}g.unwrapKey(t,f,a,l,y,p,A).then(m,u)})},p}();e.Subtle=p}(webcrypto||(webcrypto={}));