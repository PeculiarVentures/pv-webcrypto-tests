var liner=function(e){function r(o){if(t[o])return t[o].exports;var n=t[o]={exports:{},id:o,loaded:!1};return e[o].call(n.exports,n,n.exports,r),n.loaded=!0,n.exports}var t={};return r.m=e,r.c=t,r.p="",r(0)}([function(e,r,t){"use strict";var o=t(17),n=self;Object.freeze(Math),Object.freeze(Math.random),Object.freeze(Math.imul),o.nativeCrypto&&Object.freeze(o.nativeCrypto.getRandomValues),delete self.crypto,n.crypto=new o.Crypto},function(e,r,t){"use strict";function o(e){var r;r="string"==typeof e?{name:e}:e,i.checkAlgorithm(r);var t=e;return t.hash&&(t.hash=o(t.hash)),r}function n(e,r){if(!e)throw new a.WebCryptoError("Parameter '"+r+"' is required and cant be empty");if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer);if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new a.WebCryptoError("Incoming parameter '"+r+"' has wrong data type. Must be ArrayBufferView or ArrayBuffer")}var a=t(2);r.PrepareAlgorithm=o,r.PrepareData=n;var i=function(){function e(){}return e.checkAlgorithm=function(e){if("object"!=typeof e)throw new TypeError("Wrong algorithm data type. Must be Object");if(!("name"in e))throw new a.AlgorithmError(a.AlgorithmError.PARAM_REQUIRED,"name")},e.checkAlgorithmParams=function(e){this.checkAlgorithm(e)},e.checkKey=function(e,r,t,o){if(void 0===t&&(t=null),void 0===o&&(o=null),!e)throw new a.CryptoKeyError(a.CryptoKeyError.EMPTY_KEY);var n=e.algorithm;if(this.checkAlgorithm(n),r&&n.name.toUpperCase()!==r.toUpperCase())throw new a.CryptoKeyError(a.CryptoKeyError.WRONG_KEY_ALG,n.name,r);if(t&&(!e.type||e.type.toUpperCase()!==t.toUpperCase()))throw new a.CryptoKeyError(a.CryptoKeyError.WRONG_KEY_TYPE,e.type,t);if(o&&!e.usages.some(function(e){return o.toUpperCase()===e.toUpperCase()}))throw new a.CryptoKeyError(a.CryptoKeyError.WRONG_KEY_USAGE,o)},e.checkWrappedKey=function(e){if(!e.extractable)throw new a.CryptoKeyError(a.CryptoKeyError.NOT_EXTRACTABLE)},e.checkKeyUsages=function(e){if(!e||!e.length)throw new a.WebCryptoError("Parameter 'keyUsages' cannot be empty.")},e.checkFormat=function(e,r){switch(e.toLowerCase()){case"raw":if(r&&"secret"!==r.toLowerCase())throw new a.CryptoKeyError(a.CryptoKeyError.WRONG_FORMAT,r,"raw");break;case"pkcs8":if(r&&"private"!==r.toLowerCase())throw new a.CryptoKeyError(a.CryptoKeyError.WRONG_FORMAT,r,"pkcs8");break;case"spki":if(r&&"public"!==r.toLowerCase())throw new a.CryptoKeyError(a.CryptoKeyError.WRONG_FORMAT,r,"spki");break;case"jwk":break;default:throw new a.CryptoKeyError(a.CryptoKeyError.UNKNOWN_FORMAT,e)}},e.generateKey=function(e,r,t){return new Promise(function(e,r){throw new a.WebCryptoError(a.WebCryptoError.NOT_SUPPORTED)})},e.digest=function(e,r){return new Promise(function(e,r){throw new a.WebCryptoError(a.WebCryptoError.NOT_SUPPORTED)})},e.sign=function(e,r,t){return new Promise(function(e,r){throw new a.WebCryptoError(a.WebCryptoError.NOT_SUPPORTED)})},e.verify=function(e,r,t,o){return new Promise(function(e,r){throw new a.WebCryptoError(a.WebCryptoError.NOT_SUPPORTED)})},e.encrypt=function(e,r,t){return new Promise(function(e,r){throw new a.WebCryptoError(a.WebCryptoError.NOT_SUPPORTED)})},e.decrypt=function(e,r,t){return new Promise(function(e,r){throw new a.WebCryptoError(a.WebCryptoError.NOT_SUPPORTED)})},e.deriveBits=function(e,r,t){return new Promise(function(e,r){throw new a.WebCryptoError(a.WebCryptoError.NOT_SUPPORTED)})},e.deriveKey=function(e,r,t,o,n){return new Promise(function(e,r){throw new a.WebCryptoError(a.WebCryptoError.NOT_SUPPORTED)})},e.exportKey=function(e,r){return new Promise(function(e,r){throw new a.WebCryptoError(a.WebCryptoError.NOT_SUPPORTED)})},e.importKey=function(e,r,t,o,n){return new Promise(function(e,r){throw new a.WebCryptoError(a.WebCryptoError.NOT_SUPPORTED)})},e.wrapKey=function(e,r,t,o){return new Promise(function(e,r){throw new a.WebCryptoError(a.WebCryptoError.NOT_SUPPORTED)})},e.unwrapKey=function(e,r,t,o,n,i,s){return new Promise(function(e,r){throw new a.WebCryptoError(a.WebCryptoError.NOT_SUPPORTED)})},e}();r.BaseCrypto=i},function(e,r){"use strict";function t(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(var o,n=e,a=/[^%](%\d+)/g,i=[];o=a.exec(n);)i.push({arg:o[1],index:o.index});for(var s=i.length-1;s>=0;s--){var c=i[s],h=c.arg.substring(1),p=c.index+1;n=n.substring(0,p)+arguments[+h]+n.substring(p+1+h.length)}return n=n.replace("%%","%")}var o=this&&this.__extends||function(e,r){function t(){this.constructor=e}for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)},n=function(e){function r(r){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];var a=e.call(this)||this;a.code=0,a.message=t.apply(void 0,[r].concat(o));var i=new Error(a.message);return i.name=a.constructor.name,a.stack=i.stack,a}return o(r,e),r}(Error);n.NOT_SUPPORTED="Method is not supported",r.WebCryptoError=n;var a=function(e){function r(){var r=e.apply(this,arguments)||this;return r.code=1,r}return o(r,e),r}(n);a.PARAM_REQUIRED="Algorithm hasn't got required paramter '%1'",a.PARAM_WRONG_TYPE="Algorithm has got wrong type for paramter '%1'. Must be %2",a.PARAM_WRONG_VALUE="Algorithm has got wrong value for paramter '%1'. Must be %2",a.WRONG_ALG_NAME="Algorithm has got wrong name '%1'. Must be '%2'",a.UNSUPPORTED_ALGORITHM="Algorithm '%1' is not supported",a.WRONG_USAGE="Algorithm doesn't support key usage '%1'",r.AlgorithmError=a;var i=function(e){function r(){var r=e.apply(this,arguments)||this;return r.code=3,r}return o(r,e),r}(n);i.EMPTY_KEY="CryptoKey is empty",i.WRONG_KEY_ALG="CryptoKey has wrong algorithm '%1'. Must be '%2'",i.WRONG_KEY_TYPE="CryptoKey has wrong type '%1'. Must be '%2'",i.WRONG_KEY_USAGE="CryptoKey has wrong key usage. Must be '%1'",i.NOT_EXTRACTABLE="CryptoKey is not extractable",i.WRONG_FORMAT="CryptoKey has '%1' type. It can be used with '%2' format",i.UNKNOWN_FORMAT="Uknown format in use '%1'. Must be one of 'raw', 'pkcs8', 'spki'  or 'jwk'",i.ALLOWED_FORMAT="Wrong format value '%1'. Must be %2",r.CryptoKeyError=i},function(e,r){"use strict";r.AlgorithmNames={RsaSSA:"RSASSA-PKCS1-v1_5",RsaPSS:"RSA-PSS",RsaOAEP:"RSA-OAEP",AesCTR:"AES-CTR",AesCMAC:"AES-CMAC",AesGCM:"AES-GCM",AesCBC:"AES-CBC",AesKW:"AES-KW",Sha1:"SHA-1",Sha256:"SHA-256",Sha384:"SHA-384",Sha512:"SHA-512",EcDSA:"ECDSA",EcDH:"ECDH",Hmac:"HMAC",Pbkdf2:"PBKDF2"}},function(e,r,t){"use strict";function o(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}o(t(2)),o(t(1)),o(t(3)),o(t(21)),o(t(23)),o(t(10)),o(t(14)),o(t(12)),o(t(7))},function(e,r,t){"use strict";var o=this&&this.__extends||function(e,r){function t(){this.constructor=e}for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)},n=t(4),a=function(e){function r(){var r=e.apply(this,arguments)||this;return r.code=10,r}return o(r,e),r}(n.WebCryptoError);a.MODULE_NOT_FOUND="Module '%1' is not found. Download it from %2",a.UNSUPPORTED_ALGORITHM="Unsupported algorithm '%1'",r.LinerError=a},function(e,r,t){"use strict";var o=t(20),n=t(9),a=function(){function e(){this.subtle=new o.SubtleCrypto}return e.prototype.getRandomValues=function(e){return n.nativeCrypto.getRandomValues(e)},e}();r.Crypto=a},function(e,r,t){"use strict";var o=this&&this.__extends||function(e,r){function t(){this.constructor=e}for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)},n=t(3),a=t(1),i=t(2);r.ShaAlgorithms=[n.AlgorithmNames.Sha1,n.AlgorithmNames.Sha256,n.AlgorithmNames.Sha384,n.AlgorithmNames.Sha512].join(" | ");var s=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t.checkAlgorithm=function(t){var o;switch(o="string"==typeof t?{name:t}:t,e.checkAlgorithm.call(this,o),o.name.toUpperCase()){case n.AlgorithmNames.Sha1:case n.AlgorithmNames.Sha256:case n.AlgorithmNames.Sha384:case n.AlgorithmNames.Sha512:break;default:throw new i.AlgorithmError(i.AlgorithmError.WRONG_ALG_NAME,o.name,r.ShaAlgorithms)}},t.digest=function(e,r){var t=this;return new Promise(function(r,o){t.checkAlgorithm(e),r(void 0)})},t}(a.BaseCrypto);r.Sha=s},function(e,r){"use strict";function t(){var e,t={name:"",version:""},o=self.navigator.userAgent;return(e=/edge\/([\d\.]+)/i.exec(o))?(t.name=r.Browser.Edge,t.version=e[1]):/msie/i.test(o)?(t.name=r.Browser.IE,t.version=/msie ([\d\.]+)/i.exec(o)[1]):/Trident/i.test(o)?(t.name=r.Browser.IE,t.version=/rv:([\d\.]+)/i.exec(o)[1]):/chrome/i.test(o)?(t.name=r.Browser.Chrome,t.version=/chrome\/([\d\.]+)/i.exec(o)[1]):/safari/i.test(o)?(t.name=r.Browser.Safari,t.version=/([\d\.]+) safari/i.exec(o)[1]):/firefox/i.test(o)&&(t.name=r.Browser.Firefox,t.version=/firefox\/([\d\.]+)/i.exec(o)[1]),t}function o(e){for(var r=new Uint8Array(e.length),t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r}function n(e){for(var r="",t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return r}function a(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=new Uint8Array(e.map(function(e){return e.length}).reduce(function(e,r){return e+r})),o=0;return e.forEach(function(e,r){for(var n=0;n<e.length;n++)t[o+n]=e[n];o+=e.length}),t}function i(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(var o=arguments[0],n=1;n<arguments.length;n++){var a=arguments[n];for(var i in a)o[i]=a[i]}return o}r.Browser={IE:"Internet Explorer",Safari:"Safari",Edge:"Edge",Chrome:"Chrome",Firefox:"Firefox Mozilla"},r.BrowserInfo=t,r.string2buffer=o,r.buffer2string=n,r.concat=a,r.assign=i},function(e,r,t){"use strict";function o(e,r){var t=e[r];e[r]=function(){var o=arguments;return new Promise(function(n,a){var i=t.apply(e,o);i.oncomplete=function(e){console.log("Complited"),n(e.target.result)},i.onerror=function(e){console.log("Error"),a("Error on running '"+r+"' function")}})}}var n,a=t(5);if("undefined"==typeof self){var i=t(24);n={crypto:{subtle:{},getRandomValues:function(e){var r=e.buffer,t=new Uint8Array(r),o=i.randomBytes(t.length);return o.forEach(function(e,r){return t[r]=e}),e}}}}else n=self;if(r.nativeCrypto=n.msCrypto||n.crypto,r.nativeSubtle=r.nativeCrypto.subtle||r.nativeCrypto.webkitSubtle,n.msCrypto){if(!n.Promise)throw new a.LinerError(a.LinerError.MODULE_NOT_FOUND,"Promise","https://www.promisejs.org");o(r.nativeSubtle,"generateKey"),o(r.nativeSubtle,"digest"),o(r.nativeSubtle,"sign"),o(r.nativeSubtle,"verify"),o(r.nativeSubtle,"encrypt"),o(r.nativeSubtle,"decrypt"),o(r.nativeSubtle,"importKey"),o(r.nativeSubtle,"exportKey"),o(r.nativeSubtle,"wrapKey"),o(r.nativeSubtle,"unwrapKey"),o(r.nativeSubtle,"deriveKey"),o(r.nativeSubtle,"deriveBits")}Math.imul||(Math.imul=function(e,r){var t=e>>>16&65535,o=65535&e,n=r>>>16&65535,a=65535&r;return o*a+(t*a+o*n<<16>>>0)|0})},function(e,r,t){"use strict";var o=this&&this.__extends||function(e,r){function t(){this.constructor=e}for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)},n=t(2),a=t(1),i=t(3),s=function(e){function r(){var r=e.apply(this,arguments)||this;return r.code=7,r}return o(r,e),r}(n.AlgorithmError),c=function(e){function r(){return e.apply(this,arguments)||this}return o(r,e),r.checkKeyUsages=function(r){var t=this;e.checkKeyUsages.call(this,r);var o=r.filter(function(e){return t.KEY_USAGES.indexOf(e)===-1});if(o.length)throw new n.AlgorithmError(n.AlgorithmError.WRONG_USAGE,o.join(", "))},r.checkAlgorithm=function(e){if(e.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new n.AlgorithmError(n.AlgorithmError.WRONG_ALG_NAME,e.name,this.ALG_NAME)},r.checkKeyGenParams=function(e){switch(e.length){case 128:case 192:case 256:break;default:throw new s(s.PARAM_WRONG_VALUE,"length","128, 192 or 256")}},r.checkKeyGenUsages=function(e){var r=this;this.checkKeyUsages(e),e.forEach(function(e){var t=0;for(t;t<r.KEY_USAGES.length&&r.KEY_USAGES[t].toLowerCase()!==e.toLowerCase();t++);if(t===r.KEY_USAGES.length)throw new n.WebCryptoError("Unsuported key usage '"+e+"'. Should be one of ["+r.KEY_USAGES.join(", ")+"]")})},r.generateKey=function(e,r,t){var o=this;return new Promise(function(r,n){o.checkAlgorithm(e),o.checkKeyGenParams(e),o.checkKeyGenUsages(t),r(void 0)})},r.exportKey=function(e,r){var t=this;return new Promise(function(o,n){t.checkKey(r,t.ALG_NAME),t.checkFormat(e,r.type),o(void 0)})},r.importKey=function(e,r,t,o,a){var i=this;return new Promise(function(r,o){if(i.checkAlgorithm(t),i.checkFormat(e),"raw"!==e.toLowerCase()&&"jwk"!==e.toLowerCase())throw new n.CryptoKeyError(n.CryptoKeyError.ALLOWED_FORMAT,e,"'jwk' or 'raw'");i.checkKeyGenUsages(a),r(void 0)})},r}(a.BaseCrypto);c.ALG_NAME="",c.KEY_USAGES=[],r.Aes=c;var h=function(e){function r(){var r=e.apply(this,arguments)||this;return r.code=8,r}return o(r,e),r}(n.AlgorithmError);r.AesAlgorithmError=h;var p=function(e){function r(){return e.apply(this,arguments)||this}return o(r,e),r.wrapKey=function(e,r,t,o){var n=this;return new Promise(function(a,i){n.checkAlgorithmParams(o),n.checkKey(t,n.ALG_NAME,"secret","wrapKey"),n.checkWrappedKey(r),n.checkFormat(e,r.type),a(void 0)})},r.unwrapKey=function(e,r,t,o,n,a,i){var s=this;return new Promise(function(r,n){s.checkAlgorithmParams(o),s.checkKey(t,s.ALG_NAME,"secret","unwrapKey"),s.checkFormat(e),r(void 0)})},r}(c);r.AesWrapKey=p;var u=function(e){function r(){return e.apply(this,arguments)||this}return o(r,e),r.encrypt=function(e,r,t){var o=this;return new Promise(function(t,n){o.checkAlgorithmParams(e),o.checkKey(r,o.ALG_NAME,"secret","encrypt"),t(void 0)})},r.decrypt=function(e,r,t){var o=this;return new Promise(function(t,n){o.checkAlgorithmParams(e),o.checkKey(r,o.ALG_NAME,"secret","decrypt"),t(void 0)})},r}(p);u.KEY_USAGES=["encrypt","decrypt","wrapKey","unwrapKey"],r.AesEncrypt=u;var m=function(e){function r(){return e.apply(this,arguments)||this}return o(r,e),r.checkAlgorithmParams=function(e){if(this.checkAlgorithm(e),!e.iv)throw new h(h.PARAM_REQUIRED,"iv");if(!ArrayBuffer.isView(e.iv))throw new h(h.PARAM_WRONG_TYPE,"iv","ArrayBufferView");if(16!==e.iv.byteLength)throw new h(h.PARAM_WRONG_VALUE,"iv","ArrayBufferView with size 16")},r}(u);m.ALG_NAME=i.AlgorithmNames.AesCBC,r.AesCBC=m;var y=function(e){function r(){return e.apply(this,arguments)||this}return o(r,e),r.checkAlgorithmParams=function(e){if(this.checkAlgorithm(e),!e.counter||!ArrayBuffer.isView(e.counter))throw new h(h.PARAM_WRONG_TYPE,"counter","ArrayBufferView");if(16!==e.counter.byteLength)throw new h(h.PARAM_WRONG_VALUE,"counter","ArrayBufferView with size 16");if(!(e.length>0&&e.length<=128))throw new h(h.PARAM_WRONG_VALUE,"length","number [1-128]")},r}(u);y.ALG_NAME=i.AlgorithmNames.AesCTR,r.AesCTR=y;var f=function(e){function r(){return e.apply(this,arguments)||this}return o(r,e),r.checkAlgorithmParams=function(e){if(this.checkAlgorithm(e),e.additionalData&&!ArrayBuffer.isView(e.additionalData))throw new h(h.PARAM_WRONG_TYPE,"additionalData","ArrayBufferView");if(!e.iv)throw new h(h.PARAM_REQUIRED,"iv");if(!ArrayBuffer.isView(e.iv))throw new h(h.PARAM_WRONG_TYPE,"iv","ArrayBufferView");if(e.tagLength&&!(e.tagLength>=0&&e.tagLength<=128))throw new h(h.PARAM_WRONG_VALUE,"tagLength","number [0-128]")},r}(u);f.ALG_NAME=i.AlgorithmNames.AesGCM,r.AesGCM=f;var l=function(e){function r(){return e.apply(this,arguments)||this}return o(r,e),r.checkAlgorithmParams=function(e){this.checkAlgorithm(e)},r}(p);l.ALG_NAME=i.AlgorithmNames.AesKW,l.KEY_USAGES=["wrapKey","unwrapKey"],r.AesKW=l},function(e,r){"use strict";var t=function(){function e(){}return e}();r.CryptoKey=t},function(e,r,t){"use strict";var o=this&&this.__extends||function(e,r){function t(){this.constructor=e}for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)},n=t(10),a=t(7),i=t(2),s=t(1),c=t(3),h=function(e){function r(){var r=e.apply(this,arguments)||this;return r.code=9,r}return o(r,e),r}(i.AlgorithmError);r.EcKeyGenParamsError=h;var p=function(e){function r(){return e.apply(this,arguments)||this}return o(r,e),r.checkAlgorithm=function(e){if(e.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new i.AlgorithmError(i.AlgorithmError.WRONG_ALG_NAME,e.name,this.ALG_NAME)},r.checkKeyGenParams=function(e){var r="namedCurve";if(!e.namedCurve)throw new h(h.PARAM_REQUIRED,r);if("string"!=typeof e.namedCurve)throw new h(h.PARAM_WRONG_TYPE,r,"string");switch(e.namedCurve.toUpperCase()){case"P-256":case"P-384":case"P-521":break;default:throw new h(h.PARAM_WRONG_VALUE,r,"P-256, P-384 or P-521")}},r.checkKeyGenUsages=function(e){var r=this;e.forEach(function(e){var t=0;for(t;t<r.KEY_USAGES.length&&r.KEY_USAGES[t].toLowerCase()!==e.toLowerCase();t++);if(t===r.KEY_USAGES.length)throw new i.WebCryptoError("Unsuported key usage '"+e+"'. Should be one of ["+r.KEY_USAGES.join(", ")+"]")})},r.generateKey=function(e,r,t){var o=this;return new Promise(function(r,n){o.checkAlgorithm(e),o.checkKeyGenParams(e),o.checkKeyGenUsages(t),r(void 0)})},r.exportKey=function(e,r){var t=this;return new Promise(function(o,n){t.checkKey(r,t.ALG_NAME),t.checkFormat(e,r.type),o(void 0)})},r.importKey=function(e,r,t,o,n){var a=this;return new Promise(function(r,o){if(a.checkKeyGenParams(t),a.checkFormat(e),"raw"===e.toLowerCase())throw new i.CryptoKeyError(i.CryptoKeyError.ALLOWED_FORMAT,e,"'JsonWebKey', 'pkcs8' or 'spki'");a.checkKeyGenUsages(n),r(void 0)})},r}(s.BaseCrypto);p.ALG_NAME="",p.KEY_USAGES=[],r.Ec=p;var u=function(e){function r(){var r=e.apply(this,arguments)||this;return r.code=10,r}return o(r,e),r}(i.AlgorithmError);r.EcAlgorithmError=u;var m=function(e){function r(){return e.apply(this,arguments)||this}return o(r,e),r.checkAlgorithmParams=function(e){this.checkAlgorithm(e),a.Sha.checkAlgorithm(e.hash)},r.sign=function(e,r,t){var o=this;return new Promise(function(t,n){o.checkAlgorithmParams(e),o.checkKey(r,o.ALG_NAME,"private","sign"),t(void 0)})},r.verify=function(e,r,t,o){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"public","verify"),t(void 0)})},r}(p);m.ALG_NAME=c.AlgorithmNames.EcDSA,m.KEY_USAGES=["sign","verify","deriveKey","deriveBits"],r.EcDSA=m;var y=function(e){function r(){return e.apply(this,arguments)||this}return o(r,e),r.checkDeriveParams=function(e){var r="public";if(this.checkAlgorithm(e),!e.public)throw new u(u.PARAM_REQUIRED,r);this.checkKey(e.public,this.ALG_NAME,"public")},r.deriveBits=function(e,r,t){var o=this;return new Promise(function(t,n){o.checkDeriveParams(e),o.checkKey(r,o.ALG_NAME,"private","deriveBits"),t(void 0)})},r.deriveKey=function(e,r,t,o,a){var i=this;return new Promise(function(o,a){switch(i.checkDeriveParams(e),i.checkKey(r,i.ALG_NAME,"private","deriveKey"),s.BaseCrypto.checkAlgorithm(t),t.name.toUpperCase()){case c.AlgorithmNames.AesCBC:n.AesCBC.checkKeyGenParams(t);break;case c.AlgorithmNames.AesCTR:n.AesCTR.checkKeyGenParams(t);break;case c.AlgorithmNames.AesGCM:n.AesGCM.checkKeyGenParams(t);break;case c.AlgorithmNames.AesKW:n.AesKW.checkKeyGenParams(t);break;default:throw new u("Unsupported name '"+t.name+"' for algorithm in param 'derivedKeyType'")}o(void 0)})},r}(p);y.ALG_NAME=c.AlgorithmNames.EcDH,y.KEY_USAGES=["deriveKey","deriveBits"],r.EcDH=y},function(e,r,t){"use strict";var o=this&&this.__extends||function(e,r){function t(){this.constructor=e}for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)},n=t(2),a=t(1),i=t(3),s=function(e){function r(){return e.apply(this,arguments)||this}return o(r,e),r.checkAlgorithm=function(e){if(e.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new n.AlgorithmError(n.AlgorithmError.WRONG_ALG_NAME,e.name,this.ALG_NAME)},r.checkKeyGenParams=function(e){if("length"in e&&!(e.length>0&&e.length<=512))throw new n.AlgorithmError(n.AlgorithmError.PARAM_WRONG_VALUE,"length","more 0 and less than 512")},r.checkKeyGenUsages=function(e){var r=this;this.checkKeyUsages(e),e.forEach(function(e){var t=0;for(t;t<r.KEY_USAGES.length&&r.KEY_USAGES[t].toLowerCase()!==e.toLowerCase();t++);if(t===r.KEY_USAGES.length)throw new n.WebCryptoError("Unsuported key usage '"+e+"'. Should be one of ["+r.KEY_USAGES.join(", ")+"]")})},r.generateKey=function(e,r,t){var o=this;return new Promise(function(r,n){o.checkAlgorithm(e),o.checkKeyGenParams(e),o.checkKeyGenUsages(t),r(void 0)})},r.exportKey=function(e,r){var t=this;return new Promise(function(o,n){t.checkKey(r,t.ALG_NAME),t.checkFormat(e,r.type),o(void 0)})},r.importKey=function(e,r,t,o,a){var i=this;return new Promise(function(r,o){if(i.checkAlgorithm(t),i.checkFormat(e),"raw"!==e.toLowerCase()&&"jwk"!==e.toLowerCase())throw new n.CryptoKeyError(n.CryptoKeyError.ALLOWED_FORMAT,e,"'jwk' or 'raw'");i.checkKeyGenUsages(a),r(void 0)})},r.sign=function(e,r,t){var o=this;return new Promise(function(t,n){o.checkAlgorithmParams(e),o.checkKey(r,o.ALG_NAME,"secret","sign"),t(void 0)})},r.verify=function(e,r,t,o){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"secret","verify"),t(void 0)})},r}(a.BaseCrypto);s.ALG_NAME=i.AlgorithmNames.Hmac,s.KEY_USAGES=["sign","verify"],r.Hmac=s},function(e,r,t){"use strict";var o=this&&this.__extends||function(e,r){function t(){this.constructor=e}for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)},n=t(2),a=t(1),i=t(3),s=t(7),c=function(e){function r(){var r=e.apply(this,arguments)||this;return r.code=2,r}return o(r,e),r}(n.AlgorithmError);r.RsaKeyGenParamsError=c;var h=function(e){function r(){var r=e.apply(this,arguments)||this;return r.code=6,r}return o(r,e),r}(n.AlgorithmError);r.RsaHashedImportParamsError=h;var p=function(e){function r(){return e.apply(this,arguments)||this}return o(r,e),r.checkAlgorithm=function(e){if(e.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new n.AlgorithmError(n.AlgorithmError.WRONG_ALG_NAME,e.name,this.ALG_NAME)},r.checkImportAlgorithm=function(e){if(this.checkAlgorithm(e),!e.hash)throw new h(h.PARAM_REQUIRED,"hash");s.Sha.checkAlgorithm(e.hash)},r.checkKeyGenParams=function(e){switch(e.modulusLength){case 1024:case 2048:case 4096:break;default:throw new c(c.PARAM_WRONG_VALUE,"modulusLength","1024, 2048 or 4096")}var r=e.publicExponent;if(!r)throw new c(c.PARAM_REQUIRED,"publicExponent");if(!ArrayBuffer.isView(r))throw new c(c.PARAM_WRONG_TYPE,"publicExponent","ArrayBufferView");if(3!==r[0]&&(1!==r[0]||0!==r[1]||1!==r[2]))throw new c(c.PARAM_WRONG_VALUE,"publicExponent","Uint8Array([3]) | Uint8Array([1, 0, 1])");if(!e.hash)throw new c(c.PARAM_REQUIRED,"hash",s.ShaAlgorithms);s.Sha.checkAlgorithm(e.hash)},r.checkKeyGenUsages=function(e){var r=this;this.checkKeyUsages(e),e.forEach(function(e){var t=0;for(t;t<r.KEY_USAGES.length&&r.KEY_USAGES[t].toLowerCase()!==e.toLowerCase();t++);if(t===r.KEY_USAGES.length)throw new n.WebCryptoError("Unsuported key usage '"+e+"'. Should be one of ["+r.KEY_USAGES.join(", ")+"]")})},r.generateKey=function(e,r,t){var o=this;return new Promise(function(r,n){o.checkAlgorithm(e),o.checkKeyGenParams(e),o.checkKeyGenUsages(t),r(void 0)})},r.exportKey=function(e,r){var t=this;return new Promise(function(o,n){t.checkKey(r,t.ALG_NAME),t.checkFormat(e,r.type),o(void 0)})},r.importKey=function(e,r,t,o,a){var i=this;return new Promise(function(r,o){if(i.checkImportAlgorithm(t),i.checkFormat(e),"raw"===e.toLowerCase())throw new n.CryptoKeyError(n.CryptoKeyError.ALLOWED_FORMAT,e,"'JsonWebKey', 'pkcs8' or 'spki'");i.checkKeyGenUsages(a),r(void 0)})},r}(a.BaseCrypto);p.ALG_NAME="",p.KEY_USAGES=[],r.Rsa=p;var u=function(e){function r(){return e.apply(this,arguments)||this}return o(r,e),r.sign=function(e,r,t){var o=this;return new Promise(function(t,n){o.checkAlgorithmParams(e),o.checkKey(r,o.ALG_NAME,"private","sign"),t(void 0)})},r.verify=function(e,r,t,o){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"public","verify"),t(void 0)})},r}(p);u.ALG_NAME=i.AlgorithmNames.RsaSSA,u.KEY_USAGES=["sign","verify"],r.RsaSSA=u;var m=function(e){function r(){var r=e.apply(this,arguments)||this;return r.code=4,r}return o(r,e),r}(n.AlgorithmError);r.RsaPSSParamsError=m;var y=function(e){function r(){return e.apply(this,arguments)||this}return o(r,e),r.checkRsaPssParams=function(r){return e.checkAlgorithmParams.call(this,r),r.saltLength?r.saltLength%8?new m("Parameter 'saltLength' should be a multiple of 8"):void 0:new m(m.PARAM_REQUIRED,"saltLength")},r}(u);y.ALG_NAME=i.AlgorithmNames.RsaPSS,y.KEY_USAGES=["sign","verify"],r.RsaPSS=y;var f=function(e){function r(){var r=e.apply(this,arguments)||this;return r.code=5,r}return o(r,e),r}(n.AlgorithmError);r.RsaOAEPParamsError=f;var l=function(e){function r(){return e.apply(this,arguments)||this}return o(r,e),r.checkAlgorithmParams=function(e){if(e.label&&!ArrayBuffer.isView(e.label))return new f(f.PARAM_WRONG_TYPE,"label","ArrayBufferView")},r.encrypt=function(e,r,t){var o=this;return new Promise(function(t,n){o.checkAlgorithmParams(e),o.checkKey(r,o.ALG_NAME,"public","encrypt"),t(void 0)})},r.decrypt=function(e,r,t){var o=this;return new Promise(function(t,n){o.checkAlgorithmParams(e),o.checkKey(r,o.ALG_NAME,"private","decrypt"),t(void 0)})},r.wrapKey=function(e,r,t,o){var n=this;return new Promise(function(a,i){n.checkAlgorithmParams(o),n.checkKey(t,n.ALG_NAME,"public","wrapKey"),n.checkWrappedKey(r),n.checkFormat(e,r.type),a(void 0)})},r.unwrapKey=function(e,r,t,o,n,a,i){var s=this;return new Promise(function(r,n){s.checkAlgorithmParams(o),s.checkKey(t,s.ALG_NAME,"private","unwrapKey"),s.checkFormat(e),r(void 0)})},r}(p);l.ALG_NAME=i.AlgorithmNames.RsaOAEP,l.KEY_USAGES=["encrypt","decrypt","wrapKey","unwrapKey"],r.RsaOAEP=l},function(e,r,t){"use strict";var o=this&&this.__extends||function(e,r){function t(){this.constructor=e}for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)},n=t(4),a=t(5),i=t(11),s=t(8),c=t(9),h=function(e){function r(){return e.apply(this,arguments)||this}return o(r,e),r.checkModule=function(){if("undefined"==typeof asmCrypto)throw new a.LinerError(a.LinerError.MODULE_NOT_FOUND,"asmCrypto","https://github.com/vibornoff/asmcrypto.js")},r.generateKey=function(e,r,t){var o=this;return Promise.resolve().then(function(){o.checkModule();var n=c.nativeCrypto.getRandomValues(new Uint8Array(e.length/8)),a=new i.CryptoKey;return a.key=n,a.algorithm=e,a.extractable=r,a.type="secret",a.usages=t,a})},r.encrypt=function(e,r,t){return Promise.resolve().then(function(){var o;switch(e.name.toUpperCase()){case n.AlgorithmNames.AesCBC:var i=e;o=asmCrypto.AES_CBC.encrypt(t,r.key,void 0,i.iv);break;case n.AlgorithmNames.AesGCM:var s=e;s.tagLength=s.tagLength||128,o=asmCrypto.AES_GCM.encrypt(t,r.key,s.iv,s.additionalData,s.tagLength/8);break;default:throw new a.LinerError(n.AlgorithmError.UNSUPPORTED_ALGORITHM,e.name)}return o.buffer})},r.decrypt=function(e,r,t){return Promise.resolve().then(function(){var o;switch(e.name.toUpperCase()){case n.AlgorithmNames.AesCBC:var i=e;o=asmCrypto.AES_CBC.decrypt(t,r.key,void 0,i.iv);break;case n.AlgorithmNames.AesGCM:var s=e;s.tagLength=s.tagLength||128,o=asmCrypto.AES_GCM.decrypt(t,r.key,s.iv,s.additionalData,s.tagLength/8);break;default:throw new a.LinerError(n.AlgorithmError.UNSUPPORTED_ALGORITHM,e.name)}return o.buffer})},r.wrapKey=function(e,r,t,o){var n;return Promise.resolve().then(function(){return n=new p.Crypto,n.subtle.exportKey(e,r)}).then(function(e){var r;return r=e instanceof ArrayBuffer?new Uint8Array(e):s.string2buffer(JSON.stringify(e)),n.subtle.encrypt(o,t,r)})},r.unwrapKey=function(e,r,t,o,n,a,i){var c;return Promise.resolve().then(function(){return c=new p.Crypto,c.subtle.decrypt(o,t,r)}).then(function(r){var t;return t="jwk"===e.toLowerCase()?JSON.parse(s.buffer2string(new Uint8Array(r))):new Uint8Array(r),c.subtle.importKey(e,t,n,a,i)})},r.alg2jwk=function(e){return"A"+e.length+/-(\w+)/i.exec(e.name.toUpperCase())[1]},r.jwk2alg=function(e){throw new Error("Not implemented")},r.exportKey=function(e,r){var t=this;return Promise.resolve().then(function(){var o=r.key;if("jwk"===e.toLowerCase()){var a={alg:t.alg2jwk(r.algorithm),ext:r.extractable,k:n.Base64Url.encode(o),key_ops:r.usages,kty:"oct"};return a}return o.buffer})},r.importKey=function(e,r,t,o,a){return Promise.resolve().then(function(){var o;if("jwk"===e.toLowerCase()){var s=r;o=n.Base64Url.decode(s.k)}else o=new Uint8Array(r);var c=new i.CryptoKey;return c.algorithm=t,c.type="secret",c.usages=a,c.key=o,c})},r}(n.BaseCrypto);r.AesCrypto=h;var p=t(6)},function(e,r,t){"use strict";function o(e){for(var r=new Uint8Array(e),t=[],o=0;o<r.length;o++)t.push(r[o]);return t}function n(e,r){e.length%2&&(e="0"+e);for(var t=new Uint8Array(e.length/2),o=0;o<e.length;o++){var n=e.slice(o,++o+1);t[(o-1)/2]=parseInt(n,16)}if(r){var a=t.length;a=a>32?a>48?66:48:32,t.length<a&&(t=p.concat(new Uint8Array(a-t.length),t))}return t}function a(e,r){for(var t="",o=0;o<e.length;o++){var n=e[o].toString(16);t+=n.length%2?"0"+n:n}if(r){var a=e.length;a=a>32?a>48?66:48:32,t.length/2<a&&(t=new Array(2*a-t.length+1).join("0")+t)}return t}var i=this&&this.__extends||function(e,r){function t(){this.constructor=e}for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)},s=t(4),c=t(5),h=t(11),p=t(8),u=function(e){function r(){return e.apply(this,arguments)||this}return i(r,e),r.checkModule=function(){if("undefined"==typeof elliptic)throw new c.LinerError(c.LinerError.MODULE_NOT_FOUND,"elliptic","https://github.com/indutny/elliptic")},r.generateKey=function(e,r,t){var o=this;return Promise.resolve().then(function(){o.checkModule();var t=e,n=new elliptic.ec(t.namedCurve.replace("-","").toLowerCase()),a=new h.CryptoKey,i=new h.CryptoKey;return a.key=i.key=n.genKeyPair(),a.algorithm=i.algorithm=t,a.extractable=r,i.extractable=!0,a.type="private",i.type="public",e.name===s.AlgorithmNames.EcDSA?(a.usages=["sign"],i.usages=["verify"]):e.name===s.AlgorithmNames.EcDH&&(a.usages=i.usages=["deriveKey","deriveBits"]),{privateKey:a,publicKey:i}})},r.sign=function(e,r,t){return Promise.resolve().then(function(){var r=e,o=new m.Crypto;return o.subtle.digest(r.hash,t)}).then(function(e){var t=o(e),i=r.key.sign(t),s=a(i.r.toArray(),!0)+a(i.s.toArray(),!0);return n(s).buffer})},r.verify=function(e,r,t,n){var a;return Promise.resolve().then(function(){var r=e;a={r:t.slice(0,t.byteLength/2),s:t.slice(t.byteLength/2)};var o=new m.Crypto;return o.subtle.digest(r.hash,n)}).then(function(e){var t=o(e);return r.key.verify(t,a)})},r.deriveKey=function(e,r,t,o,n){var a=this;return Promise.resolve().then(function(){return a.deriveBits(e,r,t.length)}).then(function(e){var r=new m.Crypto;return r.subtle.importKey("raw",new Uint8Array(e),t,o,n)})},r.deriveBits=function(e,r,t){return Promise.resolve().then(function(){var o=(Promise.resolve(null),r.key.derive(e.public.key.getPublic())),n=new Uint8Array(o.toArray()),a=n.length;a=a>32?a>48?66:48:32,n.length<a&&(n=p.concat(new Uint8Array(a-n.length),n));var i=n.slice(0,t/8).buffer;return i})},r.exportKey=function(e,r){return Promise.resolve().then(function(){var t=r.key;if("jwk"===e.toLowerCase()){var o=t.getPublic("hex").slice(2),a=o.slice(0,o.length/2),i=o.slice(o.length/2,o.length);if("public"===r.type){var h={crv:r.algorithm.namedCurve,ext:r.extractable,x:s.Base64Url.encode(n(a,!0)),y:s.Base64Url.encode(n(i,!0)),key_ops:r.usages,kty:"EC"};return h}var h={crv:r.algorithm.namedCurve,ext:r.extractable,d:s.Base64Url.encode(n(t.getPrivate("hex"),!0)),x:s.Base64Url.encode(n(a,!0)),y:s.Base64Url.encode(n(i,!0)),key_ops:r.usages,kty:"EC"};return h}throw new c.LinerError("Format '"+e+"' is not implemented")})},r.importKey=function(e,r,t,o,n){return Promise.resolve().then(function(){var i=new h.CryptoKey;if(i.algorithm=t,"jwk"!==e.toLowerCase())throw new c.LinerError("Format '"+e+"' is not implemented");var u=new elliptic.ec(r.crv.replace("-","").toLowerCase());if(r.d)i.key=u.keyFromPrivate(s.Base64Url.decode(r.d)),i.type="private";else{
var m=p.concat(new Uint8Array([4]),s.Base64Url.decode(r.x),s.Base64Url.decode(r.y)),y=a(m);i.key=u.keyFromPublic(y,"hex"),i.type="public"}return i.extractable=o,i.usages=n,i})},r}(s.BaseCrypto);r.EcCrypto=u;var m=t(6)},function(e,r,t){"use strict";function o(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}o(t(9)),o(t(6))},function(e,r,t){"use strict";function o(e){var r=!0;return e.filter(function(e){return(!r||0!==e)&&(r=!1,!0)})}var n=this&&this.__extends||function(e,r){function t(){this.constructor=e}for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)},a=t(4),i=t(5),s=t(11),c=t(8),h=function(e){function r(){return e.apply(this,arguments)||this}return n(r,e),r.checkModule=function(){if("undefined"==typeof asmCrypto)throw new i.LinerError(i.LinerError.MODULE_NOT_FOUND,"asmCrypto","https://github.com/vibornoff/asmcrypto.js")},r.filterUsages=function(e,r){return e.filter(function(e){return!!r.filter(function(r){return e===r}).length})},r.generateKey=function(e,r,t){var o=this;return Promise.resolve().then(function(){o.checkModule();var n=3===e.publicExponent[0]?3:65537,c=asmCrypto.RSA.generateKey(e.modulusLength,n),h=new s.CryptoKey,p=new s.CryptoKey;switch(h.key=p.key=c,h.algorithm=p.algorithm=e,h.extractable=r,p.extractable=!0,h.type="private",p.type="public",e.name.toLowerCase()){case a.AlgorithmNames.RsaOAEP.toLowerCase():h.usages=o.filterUsages(["decrypt","unwrapKey"],t),p.usages=o.filterUsages(["encrypt","wrapKey"],t);break;case a.AlgorithmNames.RsaPSS.toLowerCase():h.usages=o.filterUsages(["sign"],t),p.usages=o.filterUsages(["verify"],t);break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,e.name)}return{privateKey:h,publicKey:p}})},r.sign=function(e,r,t){return Promise.resolve().then(function(){switch(e.name.toLowerCase()){case a.AlgorithmNames.RsaPSS.toLowerCase():var o=r.algorithm,n=e,s=void 0;switch(o.hash.name.toUpperCase()){case a.AlgorithmNames.Sha1:s=asmCrypto.RSA_PSS_SHA1.sign;break;case a.AlgorithmNames.Sha256:s=asmCrypto.RSA_PSS_SHA256.sign;break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,r.algorithm.name)}return s(t,r.key,n.saltLength).buffer;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,e.name)}})},r.verify=function(e,r,t,o){return Promise.resolve().then(function(){switch(e.name.toLowerCase()){case a.AlgorithmNames.RsaPSS.toLowerCase():var n=r.algorithm,s=e,c=void 0;switch(n.hash.name.toUpperCase()){case a.AlgorithmNames.Sha1:c=asmCrypto.RSA_PSS_SHA1.verify;break;case a.AlgorithmNames.Sha256:c=asmCrypto.RSA_PSS_SHA256.verify;break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,r.algorithm.name)}return c(t,o,r.key,s.saltLength);default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,e.name)}})},r.encrypt=function(e,r,t){return Promise.resolve().then(function(){switch(e.name.toLowerCase()){case a.AlgorithmNames.RsaOAEP.toLowerCase():var o=r.algorithm,n=e,s=void 0;switch(o.hash.name.toUpperCase()){case a.AlgorithmNames.Sha1:s=asmCrypto.RSA_OAEP_SHA1.encrypt;break;case a.AlgorithmNames.Sha256:s=asmCrypto.RSA_OAEP_SHA256.encrypt;break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,o.name+" "+o.hash.name)}return s(t,r.key,n.label);default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,e.name)}})},r.decrypt=function(e,r,t){return Promise.resolve().then(function(){switch(e.name.toLowerCase()){case a.AlgorithmNames.RsaOAEP.toLowerCase():var o=r.algorithm,n=e,s=void 0;switch(o.hash.name.toUpperCase()){case a.AlgorithmNames.Sha1:s=asmCrypto.RSA_OAEP_SHA1.decrypt;break;case a.AlgorithmNames.Sha256:s=asmCrypto.RSA_OAEP_SHA256.decrypt;break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,o.name+" "+o.hash.name)}return s(t,r.key,n.label);default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,e.name)}})},r.wrapKey=function(e,r,t,o){var n;return Promise.resolve().then(function(){return n=new p.Crypto,n.subtle.exportKey(e,r)}).then(function(e){var r;return r=e instanceof ArrayBuffer?new Uint8Array(e):c.string2buffer(JSON.stringify(e)),n.subtle.encrypt(o,t,r)})},r.unwrapKey=function(e,r,t,o,n,a,i){var s;return Promise.resolve().then(function(){return s=new p.Crypto,s.subtle.decrypt(o,t,r)}).then(function(r){var t;return t="jwk"===e.toLowerCase()?JSON.parse(c.buffer2string(new Uint8Array(r))):new Uint8Array(r),s.subtle.importKey(e,t,n,a,i)})},r.alg2jwk=function(e){var r=e.hash,t=/(\d+)/.exec(r.name)[1];switch(e.name.toUpperCase()){case a.AlgorithmNames.RsaOAEP.toUpperCase():return"RSA-OAEP"+("1"===t?"":"-"+t);case a.AlgorithmNames.RsaPSS.toUpperCase():return"PS"+t;case a.AlgorithmNames.RsaSSA.toUpperCase():return"RS"+t;default:throw new a.AlgorithmError(a.AlgorithmError.UNSUPPORTED_ALGORITHM,e.name)}},r.jwk2alg=function(e){throw new Error("Not implemented")},r.exportKey=function(e,r){var t=this;return Promise.resolve().then(function(){if("jwk"===e.toLowerCase()){var n={kty:"RSA",ext:!0,key_ops:r.usages};return n.alg=t.alg2jwk(r.algorithm),n.n=a.Base64Url.encode(o(r.key[0])),n.e=a.Base64Url.encode(o(r.key[1])),"private"===r.type&&(n.d=a.Base64Url.encode(o(r.key[2])),n.p=a.Base64Url.encode(o(r.key[3])),n.q=a.Base64Url.encode(o(r.key[4])),n.dp=a.Base64Url.encode(o(r.key[5])),n.dq=a.Base64Url.encode(o(r.key[6])),n.qi=a.Base64Url.encode(o(r.key[7]))),n}throw new i.LinerError(i.LinerError.NOT_SUPPORTED)})},r.importKey=function(e,r,t,o,n){return Promise.resolve().then(function(){var o,c=new s.CryptoKey;if(c.algorithm=t,c.usages=n,c.key=[],"jwk"===e.toLowerCase())return o=r,c.key[0]=a.Base64Url.decode(o.n),c.key[1]=3===a.Base64Url.decode(o.e)[0]?new Uint8Array([0,0,0,3]):new Uint8Array([0,1,0,1]),o.d?(c.type="private",c.key[2]=a.Base64Url.decode(o.d),c.key[3]=a.Base64Url.decode(o.p),c.key[4]=a.Base64Url.decode(o.q),c.key[5]=a.Base64Url.decode(o.dp),c.key[6]=a.Base64Url.decode(o.dq),c.key[7]=a.Base64Url.decode(o.qi)):c.type="public",c;throw new i.LinerError(i.LinerError.NOT_SUPPORTED)})},r}(a.BaseCrypto);r.RsaCrypto=h;var p=t(6)},function(e,r,t){"use strict";var o=this&&this.__extends||function(e,r){function t(){this.constructor=e}for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)},n=t(4),a=t(5),i=function(e){function r(){return e.apply(this,arguments)||this}return o(r,e),r.digest=function(e,r){return Promise.resolve().then(function(){if("undefined"==typeof asmCrypto)throw new a.LinerError(a.LinerError.MODULE_NOT_FOUND,"asmCrypto","https://github.com/vibornoff/asmcrypto.js");switch(e.name.toUpperCase()){case n.AlgorithmNames.Sha1:return asmCrypto.SHA1.bytes(r).buffer;case n.AlgorithmNames.Sha256:return asmCrypto.SHA256.bytes(r).buffer;default:throw new a.LinerError("Not supported algorithm '"+e.name+"'")}})},r}(n.BaseCrypto);r.ShaCrypto=i},function(e,r,t){"use strict";function o(e,r){return Promise.resolve().then(function(){if(e.key)return e;if(e.extractable){var t=new l.Crypto;return t.subtle.exportKey("jwk",e).then(function(t){return r.importKey("jwk",t,e.algorithm,!0,e.usages)})}throw new f.LinerError("'key' is Native CryptoKey. It can't be converted to JS CryptoKey")})}function n(e,r){A.BrowserInfo().name!==A.Browser.IE&&A.BrowserInfo().name!==A.Browser.Edge&&A.BrowserInfo().name!==A.Browser.Safari||!/^rsa/i.test(e.name)||(r.privateKey?(v.push({hash:e.hash,key:r.privateKey}),v.push({hash:e.hash,key:r.publicKey})):v.push({hash:e.hash,key:r}))}function a(e){var r=null;return v.some(function(t){return t.key===e&&(r=A.assign({},e.algorithm,{hash:t.hash}),!0)}),r}function i(e,r){var t=[];e.privateKey?(t.push(e.privateKey),t.push(e.publicKey)):t.push(e),t.forEach(function(e){"keyUsage"in e&&(e.usages=e.keyUsage||[],e.usages.length||(["verify","encrypt","wrapKey"].forEach(function(t){r.indexOf(t)>-1&&("public"===e.type||"secret"===e.type)&&e.usages.push(t)}),["sign","decrypt","unwrapKey","deriveKey","deriveBits"].forEach(function(t){r.indexOf(t)>-1&&("private"===e.type||"secret"===e.type)&&e.usages.push(t)})))})}function s(e,r,t){if(r&&A.BrowserInfo().name===A.Browser.IE){"extractable"in e&&(e.ext=e.extractable,delete e.extractable);var o=null;switch(r.name.toUpperCase()){case p.AlgorithmNames.RsaOAEP.toUpperCase():case p.AlgorithmNames.RsaPSS.toUpperCase():case p.AlgorithmNames.RsaSSA.toUpperCase():o=E.RsaCrypto;break;case p.AlgorithmNames.AesCBC.toUpperCase():case p.AlgorithmNames.AesGCM.toUpperCase():o=w.AesCrypto}o&&!e.alg&&(e.alg=o.alg2jwk(r)),"key_ops"in e||(e.key_ops=t)}}function c(e){A.BrowserInfo().name===A.Browser.IE&&("ext"in e&&(e.extractable=e.ext,delete e.ext),delete e.key_ops,delete e.alg)}var h=this&&this.__extends||function(e,r){function t(){this.constructor=e}for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)},p=t(4),u=t(4),m=t(4),y=t(9),f=t(5),l=t(6),A=t(8),w=t(15),g=t(19),E=t(18),C=t(16),v=[],P=function(e){function r(){return e.apply(this,arguments)||this}return h(r,e),r.prototype.generateKey=function(r,t,o){var a,s=arguments;return e.prototype.generateKey.apply(this,s).then(function(e){a=m.PrepareAlgorithm(r);try{return y.nativeSubtle.generateKey.apply(y.nativeSubtle,s).catch(function(e){console.warn("WebCrypto: native generateKey for "+a.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native generateKey for "+a.name+" doesn't work.",e.message||"")}}).then(function(e){if(e)return i(e,o),n(a,e),e;var r;switch(a.name.toLowerCase()){case p.AlgorithmNames.AesCBC.toLowerCase():case p.AlgorithmNames.AesGCM.toLowerCase():r=w.AesCrypto;break;case p.AlgorithmNames.EcDSA.toLowerCase():case p.AlgorithmNames.EcDH.toLowerCase():r=C.EcCrypto;break;case p.AlgorithmNames.RsaOAEP.toLowerCase():case p.AlgorithmNames.RsaPSS.toLowerCase():r=E.RsaCrypto;break;default:throw new f.LinerError(f.LinerError.NOT_SUPPORTED,"generateKey")}return r.generateKey(a,t,o)})},r.prototype.digest=function(r,t){var o,n,a=arguments;return e.prototype.digest.apply(this,a).then(function(e){o=m.PrepareAlgorithm(r),n=m.PrepareData(t,"data");try{return y.nativeSubtle.digest.apply(y.nativeSubtle,a).catch(function(e){console.warn("WebCrypto: native digest for "+o.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native digest for "+o.name+" doesn't work.",e.message||"")}}).then(function(e){return e?e:g.ShaCrypto.digest(o,n)})},r.prototype.sign=function(r,t,n){var i,s,c=arguments;return e.prototype.sign.apply(this,c).then(function(e){i=m.PrepareAlgorithm(r),s=m.PrepareData(n,"data");var o=a(t);o&&(c[0]=A.assign(i,o));try{return y.nativeSubtle.sign.apply(y.nativeSubtle,c).catch(function(e){console.warn("WebCrypto: native sign for "+i.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native sign for "+i.name+" doesn't work.",e.message||"")}}).then(function(e){if(e)return e;var r;switch(i.name.toLowerCase()){case p.AlgorithmNames.EcDSA.toLowerCase():r=C.EcCrypto;break;case p.AlgorithmNames.RsaPSS.toLowerCase():r=E.RsaCrypto;break;default:throw new f.LinerError(f.LinerError.NOT_SUPPORTED,"sign")}return o(t,r).then(function(e){return r.sign(i,e,s)})})},r.prototype.verify=function(r,t,n,i){var s,c,h,u=arguments;return e.prototype.verify.apply(this,u).then(function(e){s=m.PrepareAlgorithm(r),c=m.PrepareData(n,"data"),h=m.PrepareData(i,"data");var o=a(t);o&&(u[0]=A.assign(s,o));try{return y.nativeSubtle.verify.apply(y.nativeSubtle,u).catch(function(e){console.warn("WebCrypto: native verify for "+s.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native verify for "+s.name+" doesn't work.",e.message||"")}}).then(function(e){if("boolean"==typeof e)return e;var r;switch(s.name.toLowerCase()){case p.AlgorithmNames.EcDSA.toLowerCase():r=C.EcCrypto;break;case p.AlgorithmNames.RsaPSS.toLowerCase():r=E.RsaCrypto;break;default:throw new f.LinerError(f.LinerError.NOT_SUPPORTED,"sign")}return o(t,r).then(function(e){return r.verify(s,e,c,h)})})},r.prototype.deriveBits=function(r,t,o){var n,a=arguments;return e.prototype.deriveBits.apply(this,a).then(function(e){n=m.PrepareAlgorithm(r);try{return y.nativeSubtle.deriveBits.apply(y.nativeSubtle,a).catch(function(e){console.warn("WebCrypto: native deriveBits for "+n.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native deriveBits for "+n.name+" doesn't work.",e.message||"")}}).then(function(e){if(e)return e;var r;switch(n.name.toLowerCase()){case p.AlgorithmNames.EcDH.toLowerCase():r=C.EcCrypto;break;default:throw new f.LinerError(f.LinerError.NOT_SUPPORTED,"deriveBits")}return r.deriveBits(n,t,o)})},r.prototype.deriveKey=function(r,t,o,n,a){var s,c,h=arguments;return e.prototype.deriveKey.apply(this,h).then(function(e){s=m.PrepareAlgorithm(r),c=m.PrepareAlgorithm(o);try{return y.nativeSubtle.deriveKey.apply(y.nativeSubtle,h).catch(function(e){console.warn("WebCrypto: native deriveKey for "+s.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native deriveKey for "+s.name+" doesn't work.",e.message||"")}}).then(function(e){if(e)return i(e,a),e;var r;switch(s.name.toLowerCase()){case p.AlgorithmNames.EcDH.toLowerCase():r=C.EcCrypto;break;default:throw new f.LinerError(f.LinerError.NOT_SUPPORTED,"deriveBits")}return r.deriveKey(s,t,c,n,a)})},r.prototype.encrypt=function(r,t,n){var a,i,s=arguments;return e.prototype.encrypt.apply(this,s).then(function(e){a=m.PrepareAlgorithm(r),i=m.PrepareData(n,"data");try{return y.nativeSubtle.encrypt.apply(y.nativeSubtle,s).catch(function(e){console.warn("WebCrypto: native 'encrypt' for "+a.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native 'encrypt' for "+a.name+" doesn't work.",e.message||"")}}).then(function(e){if(e){if(A.BrowserInfo().name===A.Browser.IE&&a.name.toUpperCase()===p.AlgorithmNames.AesGCM&&e.ciphertext){var r=new Uint8Array(e.ciphertext.byteLength+e.tag.byteLength),n=0;new Uint8Array(e.ciphertext).forEach(function(e){return r[n++]=e}),new Uint8Array(e.tag).forEach(function(e){return r[n++]=e}),e=r.buffer}return Promise.resolve(e)}var s;switch(a.name.toLowerCase()){case p.AlgorithmNames.AesCBC.toLowerCase():case p.AlgorithmNames.AesGCM.toLowerCase():s=w.AesCrypto;break;case p.AlgorithmNames.RsaOAEP.toLowerCase():s=E.RsaCrypto;break;default:throw new f.LinerError(f.LinerError.NOT_SUPPORTED,"encrypt")}return o(t,s).then(function(e){return s.encrypt(a,e,i)})})},r.prototype.decrypt=function(r,t,n){var a,i,s=arguments;return e.prototype.decrypt.apply(this,s).then(function(e){a=m.PrepareAlgorithm(r),i=m.PrepareData(n,"data");var o=i;if(A.BrowserInfo().name===A.Browser.IE&&a.name.toUpperCase()===p.AlgorithmNames.AesGCM){var s=i.byteLength-a.tagLength/8;o={ciphertext:i.buffer.slice(0,s),tag:i.buffer.slice(s,i.byteLength)}}try{return y.nativeSubtle.decrypt.call(y.nativeSubtle,a,t,o).catch(function(e){console.warn("WebCrypto: native 'decrypt' for "+a.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native 'decrypt' for "+a.name+" doesn't work.",e.message||"")}}).then(function(e){if(e)return e;var r;switch(a.name.toLowerCase()){case p.AlgorithmNames.AesCBC.toLowerCase():case p.AlgorithmNames.AesGCM.toLowerCase():r=w.AesCrypto;break;case p.AlgorithmNames.RsaOAEP.toLowerCase():r=E.RsaCrypto;break;default:throw new f.LinerError(f.LinerError.NOT_SUPPORTED,"encrypt")}return o(t,r).then(function(e){return r.decrypt(a,e,i)})})},r.prototype.wrapKey=function(r,t,o,n){var a,i=arguments;return e.prototype.wrapKey.apply(this,i).then(function(e){a=m.PrepareAlgorithm(n);try{return y.nativeSubtle.wrapKey.apply(y.nativeSubtle,i).catch(function(e){console.warn("WebCrypto: native 'wrapKey' for "+a.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native 'wrapKey' for "+a.name+" doesn't work.",e.message||"")}}).then(function(e){if(e)return e;var n;switch(a.name.toLowerCase()){case p.AlgorithmNames.AesCBC.toLowerCase():case p.AlgorithmNames.AesGCM.toLowerCase():n=w.AesCrypto;break;case p.AlgorithmNames.RsaOAEP.toLowerCase():n=E.RsaCrypto;break;default:throw new f.LinerError(f.LinerError.NOT_SUPPORTED,"wrapKey")}return n.wrapKey(r,t,o,a)})},r.prototype.unwrapKey=function(r,t,o,n,a,s,c){var h,u,l,A=arguments;return e.prototype.unwrapKey.apply(this,A).then(function(e){h=m.PrepareAlgorithm(n),u=m.PrepareAlgorithm(a),l=m.PrepareData(t,"wrappedKey");try{return y.nativeSubtle.unwrapKey.apply(y.nativeSubtle,A).catch(function(e){console.warn("WebCrypto: native 'unwrapKey' for "+h.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native 'unwrapKey' for "+h.name+" doesn't work.",e.message||"")}}).then(function(e){if(e)return i(e,c),e;var t;switch(h.name.toLowerCase()){case p.AlgorithmNames.AesCBC.toLowerCase():case p.AlgorithmNames.AesGCM.toLowerCase():t=w.AesCrypto;break;case p.AlgorithmNames.RsaOAEP.toLowerCase():t=E.RsaCrypto;break;default:throw new f.LinerError(f.LinerError.NOT_SUPPORTED,"unwrapKey")}return t.unwrapKey(r,l,o,h,u,s,c)})},r.prototype.exportKey=function(r,t){var o=arguments;return e.prototype.exportKey.apply(this,o).then(function(){try{return y.nativeSubtle.exportKey.apply(y.nativeSubtle,o).catch(function(e){console.warn("WebCrypto: native 'exportKey' for "+t.algorithm.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native 'exportKey' for "+t.algorithm.name+" doesn't work.",e.message||"")}}).then(function(e){if(e){"jwk"===r&&e instanceof ArrayBuffer&&(e=A.buffer2string(new Uint8Array(e)),e=JSON.parse(e));var o=a(t);return o||(o=A.assign({},t.algorithm)),s(e,o,t.usages),Promise.resolve(e)}if(!t.key)throw new f.LinerError("Cannot export native CryptoKey from JS implementation");var n;switch(t.algorithm.name.toLowerCase()){case p.AlgorithmNames.AesCBC.toLowerCase():case p.AlgorithmNames.AesGCM.toLowerCase():n=w.AesCrypto;break;case p.AlgorithmNames.EcDH.toLowerCase():case p.AlgorithmNames.EcDSA.toLowerCase():n=C.EcCrypto;break;case p.AlgorithmNames.RsaPSS.toLowerCase():case p.AlgorithmNames.RsaOAEP.toLowerCase():n=E.RsaCrypto;break;default:throw new f.LinerError(f.LinerError.NOT_SUPPORTED,"exportKey")}return n.exportKey(r,t)})},r.prototype.importKey=function(r,t,o,a,s){var h,u,l=arguments;return e.prototype.importKey.apply(this,l).then(function(e){h=m.PrepareAlgorithm(o),u=t,A.BrowserInfo().name!==A.Browser.Safari&&A.BrowserInfo().name!==A.Browser.IE||(A.BrowserInfo().name===A.Browser.IE&&(t=A.assign({},t),c(t)),l[1]=A.string2buffer(JSON.stringify(t)).buffer),ArrayBuffer.isView(t)&&(u=m.PrepareData(t,"keyData"));try{return y.nativeSubtle.importKey.apply(y.nativeSubtle,l).catch(function(e){console.warn("WebCrypto: native 'importKey' for "+h.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native 'importKey' for "+h.name+" doesn't work.",e.message||"")}}).then(function(e){if(e)return n(h,e),i(e,s),Promise.resolve(e);var t;switch(h.name.toLowerCase()){case p.AlgorithmNames.AesCBC.toLowerCase():case p.AlgorithmNames.AesGCM.toLowerCase():t=w.AesCrypto;break;case p.AlgorithmNames.EcDH.toLowerCase():case p.AlgorithmNames.EcDSA.toLowerCase():t=C.EcCrypto;break;case p.AlgorithmNames.RsaPSS.toLowerCase():case p.AlgorithmNames.RsaOAEP.toLowerCase():t=E.RsaCrypto;break;default:throw new f.LinerError(f.LinerError.NOT_SUPPORTED,"importKey")}return t.importKey(r,u,h,a,s)})},r}(u.SubtleCrypto);r.SubtleCrypto=P,Uint8Array.prototype.forEach||(Uint8Array.prototype.forEach=function(e){for(var r=0;r<this.length;r++)e(this[r],r,this)}),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(e,r){return new Uint8Array(this.buffer.slice(e,r))}),Uint8Array.prototype.filter||(Uint8Array.prototype.filter=function(e){for(var r=[],t=0;t<this.length;t++)e(this[t],t,this)&&r.push(this[t]);return new Uint8Array(r)})},function(e,r){(function(e){"use strict";if("undefined"==typeof self){var t=e;t.btoa=function(e){return new Buffer(e,"binary").toString("base64")},t.atob=function(e){return new Buffer(e,"base64").toString("binary")}}var o=function(){function e(){}return e.buffer2string=function(e){for(var r="",t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return r},e.string2buffer=function(e){for(var r=new Uint8Array(e.length),t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r},e.encode=function(e){var r=this.buffer2string(e),t=btoa(r).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");return t},e.decode=function(e){for(;e.length%4;)e+="=";var r=e.replace(/\-/g,"+").replace(/_/g,"/");return this.string2buffer(atob(r))},e}();r.Base64Url=o}).call(r,function(){return this}())},function(e,r,t){"use strict";var o=this&&this.__extends||function(e,r){function t(){this.constructor=e}for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)},n=t(2),a=t(1),i=t(1),s=t(3),c=t(7),h=t(10),p=t(13),u=function(e){function r(){return e.apply(this,arguments)||this}return o(r,e),r.checkAlgorithm=function(e){if(e.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new n.AlgorithmError(n.AlgorithmError.WRONG_ALG_NAME,e.name,this.ALG_NAME)},r.checkDeriveParams=function(e){if(this.checkAlgorithm(e),!e.salt)throw new n.AlgorithmError(n.AlgorithmError.PARAM_REQUIRED,"salt");if(!(ArrayBuffer.isView(e.salt)||e.salt instanceof ArrayBuffer))throw new n.AlgorithmError(n.AlgorithmError.PARAM_WRONG_TYPE,"salt","ArrayBuffer or ArrayBufferView");if(!e.iterations)throw new n.AlgorithmError(n.AlgorithmError.PARAM_REQUIRED,"iterations");if(!e.hash)throw new n.AlgorithmError(n.AlgorithmError.PARAM_REQUIRED,"hash");var r=a.PrepareAlgorithm(e.hash);c.Sha.checkAlgorithm(r)},r.importKey=function(e,r,t,o,a){var i=this;return Promise.resolve().then(function(){if(o)throw new n.WebCryptoError("KDF keys must set extractable=false");if(i.checkAlgorithm(t),i.checkFormat(e),"raw"!==e.toLowerCase())throw new n.CryptoKeyError(n.CryptoKeyError.ALLOWED_FORMAT,e,"'raw'");i.checkKeyUsages(a)})},r.deriveKey=function(e,r,t,o,a){var c=this;return Promise.resolve().then(function(){switch(c.checkDeriveParams(e),c.checkKey(r,c.ALG_NAME,"secret","deriveKey"),i.BaseCrypto.checkAlgorithm(t),t.name.toUpperCase()){case s.AlgorithmNames.AesCBC:h.AesCBC.checkKeyGenParams(t),h.AesCBC.checkKeyUsages(a);break;case s.AlgorithmNames.AesCTR:h.AesCTR.checkKeyGenParams(t),h.AesCTR.checkKeyUsages(a);break;case s.AlgorithmNames.AesGCM:h.AesGCM.checkKeyGenParams(t),h.AesGCM.checkKeyUsages(a);break;case s.AlgorithmNames.AesKW:h.AesKW.checkKeyGenParams(t),h.AesKW.checkKeyUsages(a);break;case s.AlgorithmNames.Hmac:p.Hmac.checkKeyGenParams(t),p.Hmac.checkKeyUsages(a);break;default:throw new n.AlgorithmError(n.AlgorithmError.UNSUPPORTED_ALGORITHM,t)}})},r.deriveBits=function(e,r,t){var o=this;return Promise.resolve().then(function(){if(o.checkDeriveParams(e),o.checkKey(r,o.ALG_NAME,"secret","deriveBits"),!t||"number"!=typeof t)throw new n.WebCryptoError("Parameter 'length' must be Number and more than 0")})},r}(i.BaseCrypto);u.ALG_NAME=s.AlgorithmNames.Pbkdf2,u.KEY_USAGES=["deriveKey","deriveBits"],r.Pbkdf2=u},function(e,r,t){"use strict";var o=t(2),n=t(1),a=t(3),i=t(7),s=t(14),c=t(10),h=t(12),p=t(13),u=t(22),m=function(){function e(){}return e.prototype.generateKey=function(e,r,t){return new Promise(function(i,u){var m=n.PrepareAlgorithm(e),y=n.BaseCrypto;switch(m.name.toUpperCase()){case a.AlgorithmNames.RsaSSA.toUpperCase():y=s.RsaSSA;break;case a.AlgorithmNames.RsaOAEP.toUpperCase():y=s.RsaOAEP;break;case a.AlgorithmNames.RsaPSS.toUpperCase():y=s.RsaPSS;break;case a.AlgorithmNames.AesCBC.toUpperCase():y=c.AesCBC;break;case a.AlgorithmNames.AesCTR.toUpperCase():y=c.AesCTR;break;case a.AlgorithmNames.AesGCM.toUpperCase():y=c.AesGCM;break;case a.AlgorithmNames.AesKW.toUpperCase():y=c.AesKW;break;case a.AlgorithmNames.EcDSA.toUpperCase():y=h.EcDSA;break;case a.AlgorithmNames.EcDH.toUpperCase():y=h.EcDH;break;case a.AlgorithmNames.Hmac.toUpperCase():y=p.Hmac;break;default:throw new o.AlgorithmError(o.AlgorithmError.UNSUPPORTED_ALGORITHM,m.name)}y.generateKey(m,r,t).then(i,u)})},e.prototype.digest=function(e,r){return new Promise(function(t,s){var c=n.PrepareAlgorithm(e),h=n.PrepareData(r,"data"),p=n.BaseCrypto;switch(c.name.toUpperCase()){case a.AlgorithmNames.Sha1.toUpperCase():case a.AlgorithmNames.Sha256.toUpperCase():case a.AlgorithmNames.Sha384.toUpperCase():case a.AlgorithmNames.Sha512.toUpperCase():p=i.Sha;break;default:throw new o.AlgorithmError(o.AlgorithmError.UNSUPPORTED_ALGORITHM,c.name)}p.digest(c,h).then(t,s)})},e.prototype.sign=function(e,r,t){return new Promise(function(i,c){var u=n.PrepareAlgorithm(e),m=n.PrepareData(t,"data"),y=n.BaseCrypto;switch(u.name.toUpperCase()){case a.AlgorithmNames.RsaSSA.toUpperCase():y=s.RsaSSA;break;case a.AlgorithmNames.RsaPSS.toUpperCase():y=s.RsaPSS;break;case a.AlgorithmNames.EcDSA.toUpperCase():y=h.EcDSA;break;case a.AlgorithmNames.Hmac.toUpperCase():y=p.Hmac;break;default:throw new o.AlgorithmError(o.AlgorithmError.UNSUPPORTED_ALGORITHM,u.name)}y.sign(u,r,m).then(i,c)})},e.prototype.verify=function(e,r,t,i){return new Promise(function(t,c){var u=n.PrepareAlgorithm(e),m=n.PrepareData(i,"signature"),y=n.PrepareData(i,"data"),f=n.BaseCrypto;switch(u.name.toUpperCase()){case a.AlgorithmNames.RsaSSA.toUpperCase():f=s.RsaSSA;break;case a.AlgorithmNames.RsaPSS.toUpperCase():f=s.RsaPSS;break;case a.AlgorithmNames.EcDSA.toUpperCase():f=h.EcDSA;break;case a.AlgorithmNames.Hmac.toUpperCase():f=p.Hmac;break;default:throw new o.AlgorithmError(o.AlgorithmError.UNSUPPORTED_ALGORITHM,u.name)}f.verify(u,r,m,y).then(t,c)})},e.prototype.encrypt=function(e,r,t){return new Promise(function(i,h){var p=n.PrepareAlgorithm(e),u=n.PrepareData(t,"data"),m=n.BaseCrypto;switch(p.name.toUpperCase()){case a.AlgorithmNames.RsaOAEP.toUpperCase():m=s.RsaOAEP;break;case a.AlgorithmNames.AesCBC.toUpperCase():m=c.AesCBC;break;case a.AlgorithmNames.AesCTR.toUpperCase():m=c.AesCTR;break;case a.AlgorithmNames.AesGCM.toUpperCase():m=c.AesGCM;break;default:throw new o.AlgorithmError(o.AlgorithmError.UNSUPPORTED_ALGORITHM,p.name)}m.encrypt(p,r,u).then(i,h)})},e.prototype.decrypt=function(e,r,t){return new Promise(function(i,h){var p=n.PrepareAlgorithm(e),u=n.PrepareData(t,"data"),m=n.BaseCrypto;switch(p.name.toUpperCase()){case a.AlgorithmNames.RsaOAEP.toUpperCase():m=s.RsaOAEP;break;case a.AlgorithmNames.AesCBC.toUpperCase():m=c.AesCBC;break;case a.AlgorithmNames.AesCTR.toUpperCase():m=c.AesCTR;break;case a.AlgorithmNames.AesGCM.toUpperCase():m=c.AesGCM;break;default:throw new o.AlgorithmError(o.AlgorithmError.UNSUPPORTED_ALGORITHM,p.name)}m.decrypt(p,r,u).then(i,h)})},e.prototype.deriveBits=function(e,r,t){return new Promise(function(i,s){var c=n.PrepareAlgorithm(e),p=n.BaseCrypto;switch(c.name.toUpperCase()){case a.AlgorithmNames.EcDH.toUpperCase():p=h.EcDH;break;case a.AlgorithmNames.Pbkdf2.toUpperCase():p=u.Pbkdf2;break;default:throw new o.AlgorithmError(o.AlgorithmError.UNSUPPORTED_ALGORITHM,c.name)}p.deriveBits(c,r,t).then(i,s)})},e.prototype.deriveKey=function(e,r,t,i,s){return new Promise(function(c,p){var m=n.PrepareAlgorithm(e),y=n.PrepareAlgorithm(t),f=n.BaseCrypto;switch(m.name.toUpperCase()){case a.AlgorithmNames.EcDH.toUpperCase():f=h.EcDH;break;case a.AlgorithmNames.Pbkdf2.toUpperCase():f=u.Pbkdf2;break;default:throw new o.AlgorithmError(o.AlgorithmError.UNSUPPORTED_ALGORITHM,m.name)}f.deriveKey(m,r,y,i,s).then(c,p)})},e.prototype.exportKey=function(e,r){return new Promise(function(t,i){if(n.BaseCrypto.checkKey(r),!r.extractable)throw new o.CryptoKeyError(o.CryptoKeyError.NOT_EXTRACTABLE);var u=n.BaseCrypto;switch(r.algorithm.name.toUpperCase()){case a.AlgorithmNames.RsaSSA.toUpperCase():u=s.RsaSSA;break;case a.AlgorithmNames.RsaPSS.toUpperCase():u=s.RsaPSS;break;case a.AlgorithmNames.RsaOAEP.toUpperCase():u=s.RsaOAEP;break;case a.AlgorithmNames.AesCBC.toUpperCase():u=c.AesCBC;break;case a.AlgorithmNames.AesCTR.toUpperCase():u=c.AesCTR;break;case a.AlgorithmNames.AesGCM.toUpperCase():u=c.AesGCM;break;case a.AlgorithmNames.AesKW.toUpperCase():u=c.AesKW;break;case a.AlgorithmNames.EcDSA.toUpperCase():u=h.EcDSA;break;case a.AlgorithmNames.EcDH.toUpperCase():u=h.EcDH;break;case a.AlgorithmNames.Hmac.toUpperCase():u=p.Hmac;break;default:throw new o.AlgorithmError(o.AlgorithmError.UNSUPPORTED_ALGORITHM,r.algorithm.name)}u.exportKey(e,r).then(t,i)})},e.prototype.importKey=function(e,r,t,i,m){return new Promise(function(y,f){var l=n.PrepareAlgorithm(t),A=n.BaseCrypto;switch(l.name.toUpperCase()){case a.AlgorithmNames.RsaSSA.toUpperCase():A=s.RsaSSA;break;case a.AlgorithmNames.RsaPSS.toUpperCase():A=s.RsaPSS;break;case a.AlgorithmNames.RsaOAEP.toUpperCase():A=s.RsaOAEP;break;case a.AlgorithmNames.AesCBC.toUpperCase():A=c.AesCBC;break;case a.AlgorithmNames.AesCTR.toUpperCase():A=c.AesCTR;break;case a.AlgorithmNames.AesGCM.toUpperCase():A=c.AesGCM;break;case a.AlgorithmNames.AesKW.toUpperCase():A=c.AesKW;break;case a.AlgorithmNames.EcDSA.toUpperCase():A=h.EcDSA;break;case a.AlgorithmNames.EcDH.toUpperCase():A=h.EcDH;break;case a.AlgorithmNames.Hmac.toUpperCase():A=p.Hmac;break;case a.AlgorithmNames.Pbkdf2.toUpperCase():A=u.Pbkdf2;break;default:throw new o.AlgorithmError(o.AlgorithmError.UNSUPPORTED_ALGORITHM,l.name)}A.importKey(e,r,l,i,m).then(y,f)})},e.prototype.wrapKey=function(e,r,t,i){return new Promise(function(h,p){var u=n.PrepareAlgorithm(i),m=n.BaseCrypto;switch(u.name.toUpperCase()){case a.AlgorithmNames.RsaOAEP.toUpperCase():m=s.RsaOAEP;break;case a.AlgorithmNames.AesCBC.toUpperCase():m=c.AesCBC;break;case a.AlgorithmNames.AesCTR.toUpperCase():m=c.AesCTR;break;case a.AlgorithmNames.AesGCM.toUpperCase():m=c.AesGCM;break;case a.AlgorithmNames.AesKW.toUpperCase():m=c.AesKW;break;default:throw new o.AlgorithmError(o.AlgorithmError.UNSUPPORTED_ALGORITHM,u.name)}m.wrapKey(e,r,t,u).then(h,p)})},e.prototype.unwrapKey=function(e,r,t,i,h,p,u){return new Promise(function(m,y){var f=n.PrepareAlgorithm(i),l=n.PrepareAlgorithm(h),A=n.PrepareData(r,"wrappedKey"),w=n.BaseCrypto;switch(f.name.toUpperCase()){case a.AlgorithmNames.RsaOAEP.toUpperCase():w=s.RsaOAEP;break;case a.AlgorithmNames.AesCBC.toUpperCase():w=c.AesCBC;break;case a.AlgorithmNames.AesCTR.toUpperCase():w=c.AesCTR;break;case a.AlgorithmNames.AesGCM.toUpperCase():w=c.AesGCM;break;case a.AlgorithmNames.AesKW.toUpperCase():w=c.AesKW;break;default:throw new o.AlgorithmError(o.AlgorithmError.UNSUPPORTED_ALGORITHM,f.name)}w.unwrapKey(e,A,t,f,l,p,u).then(m,y)})},e}();r.SubtleCrypto=m},function(e,r){e.exports=require("crypto")}]);