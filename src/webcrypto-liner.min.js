var liner=function(e){function r(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}var t={};return r.m=e,r.c=t,r.p="",r(0)}([function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(9),o=self;Object.freeze(Math),Object.freeze(Math.random),Object.freeze(Math.imul),n.nativeCrypto&&Object.freeze(n.nativeCrypto.getRandomValues),delete self.crypto,o.crypto=new n.Crypto,Object.freeze(o.crypto),r.crypto=o.crypto},function(e,r,t){(function(e){"use strict";function n(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(var n,o=e,a=/[^%](%\d+)/g,i=[];n=a.exec(o);)i.push({arg:n[1],index:n.index});for(var s=i.length-1;s>=0;s--){var c=i[s],u=c.arg.substring(1),h=c.index+1;o=o.substring(0,h)+arguments[+u]+o.substring(h+1+u.length)}return o=o.replace("%%","%")}function o(e){var r;r="string"==typeof e?{name:e}:e,h.checkAlgorithm(r);var t=e;return t.hash&&(t.hash=o(t.hash)),r}function a(e,r){if(!e)throw new s("Parameter '"+r+"' is required and cant be empty");if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer);if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new s("Incoming parameter '"+r+"' has wrong data type. Must be ArrayBufferView or ArrayBuffer")}Object.defineProperty(r,"__esModule",{value:!0});var i=t(13),s=function(e){function r(r){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var a=e.call(this)||this;a.code=0,a.message=n.apply(void 0,[r].concat(t));var i=new Error(a.message);return i.name=a.constructor.name,a.stack=i.stack,a}return i.__extends(r,e),r}(Error);s.NOT_SUPPORTED="Method is not supported";var c=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=1,r}return i.__extends(r,e),r}(s);c.PARAM_REQUIRED="Algorithm hasn't got required paramter '%1'",c.PARAM_WRONG_TYPE="Algorithm has got wrong type for paramter '%1'. Must be %2",c.PARAM_WRONG_VALUE="Algorithm has got wrong value for paramter '%1'. Must be %2",c.WRONG_ALG_NAME="Algorithm has got wrong name '%1'. Must be '%2'",c.UNSUPPORTED_ALGORITHM="Algorithm '%1' is not supported",c.WRONG_USAGE="Algorithm doesn't support key usage '%1'";var u=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=3,r}return i.__extends(r,e),r}(s);u.EMPTY_KEY="CryptoKey is empty",u.WRONG_KEY_ALG="CryptoKey has wrong algorithm '%1'. Must be '%2'",u.WRONG_KEY_TYPE="CryptoKey has wrong type '%1'. Must be '%2'",u.WRONG_KEY_USAGE="CryptoKey has wrong key usage. Must be '%1'",u.NOT_EXTRACTABLE="CryptoKey is not extractable",u.WRONG_FORMAT="CryptoKey has '%1' type. It can be used with '%2' format",u.UNKNOWN_FORMAT="Unknown format in use '%1'. Must be one of 'raw', 'pkcs8', 'spki'  or 'jwk'",u.ALLOWED_FORMAT="Wrong format value '%1'. Must be %2";var h=function(){function e(){}return e.checkAlgorithm=function(e){if("object"!=typeof e)throw new TypeError("Wrong algorithm data type. Must be Object");if(!("name"in e))throw new c(c.PARAM_REQUIRED,"name")},e.checkAlgorithmParams=function(e){this.checkAlgorithm(e)},e.checkKey=function(e,r,t,n){if(void 0===t&&(t=null),void 0===n&&(n=null),!e)throw new u(u.EMPTY_KEY);var o=e.algorithm;if(this.checkAlgorithm(o),r&&o.name.toUpperCase()!==r.toUpperCase())throw new u(u.WRONG_KEY_ALG,o.name,r);if(t&&(!e.type||e.type.toUpperCase()!==t.toUpperCase()))throw new u(u.WRONG_KEY_TYPE,e.type,t);if(n&&!e.usages.some(function(e){return n.toUpperCase()===e.toUpperCase()}))throw new u(u.WRONG_KEY_USAGE,n)},e.checkWrappedKey=function(e){if(!e.extractable)throw new u(u.NOT_EXTRACTABLE)},e.checkKeyUsages=function(e){if(!e||!e.length)throw new s("Parameter 'keyUsages' cannot be empty.")},e.checkFormat=function(e,r){switch(e.toLowerCase()){case"raw":if(r&&"secret"!==r.toLowerCase()&&r&&"public"!==r.toLowerCase())throw new u(u.WRONG_FORMAT,r,"raw");break;case"pkcs8":if(r&&"private"!==r.toLowerCase())throw new u(u.WRONG_FORMAT,r,"pkcs8");break;case"spki":if(r&&"public"!==r.toLowerCase())throw new u(u.WRONG_FORMAT,r,"spki");break;case"jwk":break;default:throw new u(u.UNKNOWN_FORMAT,e)}},e.generateKey=function(e,r,t){return new Promise(function(e,r){throw new s(s.NOT_SUPPORTED)})},e.digest=function(e,r){return new Promise(function(e,r){throw new s(s.NOT_SUPPORTED)})},e.sign=function(e,r,t){return new Promise(function(e,r){throw new s(s.NOT_SUPPORTED)})},e.verify=function(e,r,t,n){return new Promise(function(e,r){throw new s(s.NOT_SUPPORTED)})},e.encrypt=function(e,r,t){return new Promise(function(e,r){throw new s(s.NOT_SUPPORTED)})},e.decrypt=function(e,r,t){return new Promise(function(e,r){throw new s(s.NOT_SUPPORTED)})},e.deriveBits=function(e,r,t){return new Promise(function(e,r){throw new s(s.NOT_SUPPORTED)})},e.deriveKey=function(e,r,t,n,o){return new Promise(function(e,r){throw new s(s.NOT_SUPPORTED)})},e.exportKey=function(e,r){return new Promise(function(e,r){throw new s(s.NOT_SUPPORTED)})},e.importKey=function(e,r,t,n,o){return new Promise(function(e,r){throw new s(s.NOT_SUPPORTED)})},e.wrapKey=function(e,r,t,n){return new Promise(function(e,r){throw new s(s.NOT_SUPPORTED)})},e.unwrapKey=function(e,r,t,n,o,a,i){return new Promise(function(e,r){throw new s(s.NOT_SUPPORTED)})},e}(),p={RsaSSA:"RSASSA-PKCS1-v1_5",RsaPSS:"RSA-PSS",RsaOAEP:"RSA-OAEP",AesCTR:"AES-CTR",AesCMAC:"AES-CMAC",AesGCM:"AES-GCM",AesCBC:"AES-CBC",AesKW:"AES-KW",Sha1:"SHA-1",Sha256:"SHA-256",Sha384:"SHA-384",Sha512:"SHA-512",EcDSA:"ECDSA",EcDH:"ECDH",Hmac:"HMAC",Pbkdf2:"PBKDF2"};if("undefined"==typeof self){var f=e;f.btoa=function(e){return new Buffer(e,"binary").toString("base64")},f.atob=function(e){return new Buffer(e,"base64").toString("binary")}}var l=function(){function e(){}return e.encode=function(e){var r=this.buffer2string(e),t=btoa(r).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");return t},e.decode=function(e){for(;e.length%4;)e+="=";var r=e.replace(/\-/g,"+").replace(/_/g,"/");return this.string2buffer(atob(r))},e.buffer2string=function(e){for(var r="",t=e.length,n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r},e.string2buffer=function(e){for(var r=new Uint8Array(e.length),t=e.length,n=0;n<t;n++)r[n]=e.charCodeAt(n);return r},e}(),y=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=7,r}return i.__extends(r,e),r}(c),m=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),r.checkKeyUsages=function(r){var t=this;e.checkKeyUsages.call(this,r);var n=r.filter(function(e){return t.KEY_USAGES.indexOf(e)===-1});if(n.length)throw new c(c.WRONG_USAGE,n.join(", "))},r.checkAlgorithm=function(e){if(e.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new c(c.WRONG_ALG_NAME,e.name,this.ALG_NAME)},r.checkKeyGenParams=function(e){switch(e.length){case 128:case 192:case 256:break;default:throw new y(y.PARAM_WRONG_VALUE,"length","128, 192 or 256")}},r.generateKey=function(e,r,t){var n=this;return new Promise(function(r,o){n.checkAlgorithm(e),n.checkKeyGenParams(e),n.checkKeyUsages(t),r(void 0)})},r.exportKey=function(e,r){var t=this;return new Promise(function(n,o){t.checkKey(r,t.ALG_NAME),t.checkFormat(e,r.type),n(void 0)})},r.importKey=function(e,r,t,n,o){var a=this;return new Promise(function(r,n){if(a.checkAlgorithm(t),a.checkFormat(e),"raw"!==e.toLowerCase()&&"jwk"!==e.toLowerCase())throw new u(u.ALLOWED_FORMAT,e,"'jwk' or 'raw'");a.checkKeyUsages(o),r(void 0)})},r}(h);m.ALG_NAME="",m.KEY_USAGES=[];var w=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=8,r}return i.__extends(r,e),r}(c),A=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),r.wrapKey=function(e,r,t,n){var o=this;return new Promise(function(a,i){o.checkAlgorithmParams(n),o.checkKey(t,o.ALG_NAME,"secret","wrapKey"),o.checkWrappedKey(r),o.checkFormat(e,r.type),a(void 0)})},r.unwrapKey=function(e,r,t,n,o,a,i){var s=this;return new Promise(function(r,o){s.checkAlgorithmParams(n),s.checkKey(t,s.ALG_NAME,"secret","unwrapKey"),s.checkFormat(e),r(void 0)})},r}(m),v=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),r.encrypt=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"secret","encrypt"),t(void 0)})},r.decrypt=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"secret","decrypt"),t(void 0)})},r}(A);v.KEY_USAGES=["encrypt","decrypt","wrapKey","unwrapKey"];var g=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),r.checkAlgorithmParams=function(e){if(this.checkAlgorithm(e),!e.iv)throw new w(w.PARAM_REQUIRED,"iv");if(!(ArrayBuffer.isView(e.iv)||e.iv instanceof ArrayBuffer))throw new w(w.PARAM_WRONG_TYPE,"iv","ArrayBufferView or ArrayBuffer");if(16!==e.iv.byteLength)throw new w(w.PARAM_WRONG_VALUE,"iv","ArrayBufferView or ArrayBuffer with size 16")},r}(v);g.ALG_NAME=p.AesCBC;var d=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),r.checkAlgorithmParams=function(e){if(this.checkAlgorithm(e),!e.counter||!(ArrayBuffer.isView(e.counter)||e.counter instanceof ArrayBuffer))throw new w(w.PARAM_WRONG_TYPE,"counter","ArrayBufferView or ArrayBuffer");if(16!==e.counter.byteLength)throw new w(w.PARAM_WRONG_VALUE,"counter","ArrayBufferView or ArrayBuffer with size 16");if(!(e.length>0&&e.length<=128))throw new w(w.PARAM_WRONG_VALUE,"length","number [1-128]")},r}(v);d.ALG_NAME=p.AesCTR;var C=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),r.checkAlgorithmParams=function(e){if(this.checkAlgorithm(e),e.additionalData&&!(ArrayBuffer.isView(e.additionalData)||e.additionalData instanceof ArrayBuffer))throw new w(w.PARAM_WRONG_TYPE,"additionalData","ArrayBufferView or ArrayBuffer");if(!e.iv)throw new w(w.PARAM_REQUIRED,"iv");if(!(ArrayBuffer.isView(e.iv)||e.iv instanceof ArrayBuffer))throw new w(w.PARAM_WRONG_TYPE,"iv","ArrayBufferView or ArrayBuffer");if(e.tagLength){var r=[32,64,96,104,112,120,128].some(function(r){return r===e.tagLength});if(!r)throw new w(w.PARAM_WRONG_VALUE,"tagLength","32, 64, 96, 104, 112, 120 or 128")}},r}(v);C.ALG_NAME=p.AesGCM;var _=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),r.checkAlgorithmParams=function(e){this.checkAlgorithm(e)},r}(A);_.ALG_NAME=p.AesKW,_.KEY_USAGES=["wrapKey","unwrapKey"];var P=[p.Sha1,p.Sha256,p.Sha384,p.Sha512].join(" | "),E=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),r.checkAlgorithm=function(r){var t;switch(t="string"==typeof r?{name:r}:r,e.checkAlgorithm.call(this,t),t.name.toUpperCase()){case p.Sha1:case p.Sha256:case p.Sha384:case p.Sha512:break;default:throw new c(c.WRONG_ALG_NAME,t.name,P)}},r.digest=function(e,r){var t=this;return new Promise(function(r,n){t.checkAlgorithm(e),r(void 0)})},r}(h),b=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=9,r}return i.__extends(r,e),r}(c),k=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),r.checkAlgorithm=function(e){if(e.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new c(c.WRONG_ALG_NAME,e.name,this.ALG_NAME)},r.checkKeyGenParams=function(e){var r="namedCurve";if(!e.namedCurve)throw new b(b.PARAM_REQUIRED,r);if("string"!=typeof e.namedCurve)throw new b(b.PARAM_WRONG_TYPE,r,"string");switch(e.namedCurve.toUpperCase()){case"P-256":case"P-384":case"P-521":break;default:throw new b(b.PARAM_WRONG_VALUE,r,"P-256, P-384 or P-521")}},r.checkKeyGenUsages=function(e){var r=this;e.forEach(function(e){var t=0;for(t;t<r.KEY_USAGES.length&&r.KEY_USAGES[t].toLowerCase()!==e.toLowerCase();t++);if(t===r.KEY_USAGES.length)throw new s("Unsupported key usage '"+e+"'. Should be one of ["+r.KEY_USAGES.join(", ")+"]")})},r.generateKey=function(e,r,t){var n=this;return new Promise(function(r,o){n.checkAlgorithm(e),n.checkKeyGenParams(e),n.checkKeyGenUsages(t),r(void 0)})},r.exportKey=function(e,r){var t=this;return new Promise(function(n,o){t.checkKey(r,t.ALG_NAME),e&&"raw"===e.toLowerCase()&&"public"===r.type||t.checkFormat(e,r.type),n(void 0)})},r.importKey=function(e,r,t,n,o){var a=this;return new Promise(function(r,n){a.checkKeyGenParams(t),a.checkFormat(e),a.checkKeyGenUsages(o),r(void 0)})},r}(h);k.ALG_NAME="",k.KEY_USAGES=[];var U=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=10,r}return i.__extends(r,e),r}(c),S=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),r.checkAlgorithmParams=function(e){this.checkAlgorithm(e),E.checkAlgorithm(e.hash)},r.sign=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"private","sign"),t(void 0)})},r.verify=function(e,r,t,n){var o=this;return new Promise(function(t,n){o.checkAlgorithmParams(e),o.checkKey(r,o.ALG_NAME,"public","verify"),t(void 0)})},r}(k);S.ALG_NAME=p.EcDSA,S.KEY_USAGES=["sign","verify","deriveKey","deriveBits"];var R=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),r.checkDeriveParams=function(e){var r="public";if(this.checkAlgorithm(e),!e.public)throw new U(U.PARAM_REQUIRED,r);this.checkKey(e.public,this.ALG_NAME,"public")},r.deriveBits=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkDeriveParams(e),n.checkKey(r,n.ALG_NAME,"private","deriveBits"),t(void 0)})},r.deriveKey=function(e,r,t,n,o){var a=this;return new Promise(function(n,o){switch(a.checkDeriveParams(e),a.checkKey(r,a.ALG_NAME,"private","deriveKey"),h.checkAlgorithm(t),t.name.toUpperCase()){case p.AesCBC:g.checkKeyGenParams(t);break;case p.AesCTR:d.checkKeyGenParams(t);break;case p.AesGCM:C.checkKeyGenParams(t);break;case p.AesKW:_.checkKeyGenParams(t);break;default:throw new U("Unsupported name '"+t.name+"' for algorithm in param 'derivedKeyType'")}n(void 0)})},r}(k);R.ALG_NAME=p.EcDH,R.KEY_USAGES=["deriveKey","deriveBits"];var L=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),r.checkAlgorithm=function(e){if(e.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new c(c.WRONG_ALG_NAME,e.name,this.ALG_NAME)},r.checkKeyGenParams=function(e){if("length"in e&&!(e.length>0&&e.length<=512))throw new c(c.PARAM_WRONG_VALUE,"length","more 0 and less than 512")},r.checkKeyGenUsages=function(e){var r=this;this.checkKeyUsages(e),e.forEach(function(e){var t=0;for(t;t<r.KEY_USAGES.length&&r.KEY_USAGES[t].toLowerCase()!==e.toLowerCase();t++);if(t===r.KEY_USAGES.length)throw new s("Unsupported key usage '"+e+"'. Should be one of ["+r.KEY_USAGES.join(", ")+"]")})},r.generateKey=function(e,r,t){var n=this;return new Promise(function(r,o){n.checkAlgorithm(e),n.checkKeyGenParams(e),n.checkKeyGenUsages(t),r(void 0)})},r.exportKey=function(e,r){var t=this;return new Promise(function(n,o){t.checkKey(r,t.ALG_NAME),t.checkFormat(e,r.type),n(void 0)})},r.importKey=function(e,r,t,n,o){var a=this;return new Promise(function(r,n){if(a.checkAlgorithm(t),a.checkFormat(e),"raw"!==e.toLowerCase()&&"jwk"!==e.toLowerCase())throw new u(u.ALLOWED_FORMAT,e,"'jwk' or 'raw'");a.checkKeyGenUsages(o),r(void 0)})},r.sign=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"secret","sign"),t(void 0)})},r.verify=function(e,r,t,n){var o=this;return new Promise(function(t,n){o.checkAlgorithmParams(e),o.checkKey(r,o.ALG_NAME,"secret","verify"),t(void 0)})},r}(h);L.ALG_NAME=p.Hmac,L.KEY_USAGES=["sign","verify"];var O=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),r.checkAlgorithm=function(e){if(e.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new c(c.WRONG_ALG_NAME,e.name,this.ALG_NAME)},r.checkDeriveParams=function(e){if(this.checkAlgorithm(e),!e.salt)throw new c(c.PARAM_REQUIRED,"salt");if(!(ArrayBuffer.isView(e.salt)||e.salt instanceof ArrayBuffer))throw new c(c.PARAM_WRONG_TYPE,"salt","ArrayBuffer or ArrayBufferView");if(!e.iterations)throw new c(c.PARAM_REQUIRED,"iterations");if(!e.hash)throw new c(c.PARAM_REQUIRED,"hash");var r=o(e.hash);E.checkAlgorithm(r)},r.importKey=function(e,r,t,n,o){var a=this;return Promise.resolve().then(function(){if(n)throw new s("KDF keys must set extractable=false");if(a.checkAlgorithm(t),a.checkFormat(e),"raw"!==e.toLowerCase())throw new u(u.ALLOWED_FORMAT,e,"'raw'");a.checkKeyUsages(o)})},r.deriveKey=function(e,r,t,n,o){var a=this;return Promise.resolve().then(function(){switch(a.checkDeriveParams(e),a.checkKey(r,a.ALG_NAME,"secret","deriveKey"),h.checkAlgorithm(t),t.name.toUpperCase()){case p.AesCBC:g.checkKeyGenParams(t),g.checkKeyUsages(o);break;case p.AesCTR:d.checkKeyGenParams(t),d.checkKeyUsages(o);break;case p.AesGCM:C.checkKeyGenParams(t),C.checkKeyUsages(o);break;case p.AesKW:_.checkKeyGenParams(t),_.checkKeyUsages(o);break;case p.Hmac:L.checkKeyGenParams(t),L.checkKeyUsages(o);break;default:throw new c(c.UNSUPPORTED_ALGORITHM,t)}})},r.deriveBits=function(e,r,t){var n=this;return Promise.resolve().then(function(){if(n.checkDeriveParams(e),n.checkKey(r,n.ALG_NAME,"secret","deriveBits"),!t||"number"!=typeof t)throw new s("Parameter 'length' must be Number and more than 0")})},r}(h);O.ALG_NAME=p.Pbkdf2,O.KEY_USAGES=["deriveKey","deriveBits"];var K=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=2,r}return i.__extends(r,e),r}(c),N=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=6,r}return i.__extends(r,e),r}(c),G=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),r.checkAlgorithm=function(e){if(e.name.toUpperCase()!==this.ALG_NAME.toUpperCase())throw new c(c.WRONG_ALG_NAME,e.name,this.ALG_NAME)},r.checkImportAlgorithm=function(e){if(this.checkAlgorithm(e),!e.hash)throw new N(N.PARAM_REQUIRED,"hash");E.checkAlgorithm(e.hash)},r.checkKeyGenParams=function(e){switch(e.modulusLength){case 1024:case 2048:case 4096:break;default:throw new K(K.PARAM_WRONG_VALUE,"modulusLength","1024, 2048 or 4096")}var r=e.publicExponent;if(!r)throw new K(K.PARAM_REQUIRED,"publicExponent");if(!ArrayBuffer.isView(r))throw new K(K.PARAM_WRONG_TYPE,"publicExponent","ArrayBufferView");if(3!==r[0]&&(1!==r[0]||0!==r[1]||1!==r[2]))throw new K(K.PARAM_WRONG_VALUE,"publicExponent","Uint8Array([3]) | Uint8Array([1, 0, 1])");if(!e.hash)throw new K(K.PARAM_REQUIRED,"hash",P);E.checkAlgorithm(e.hash)},r.checkKeyGenUsages=function(e){var r=this;this.checkKeyUsages(e),e.forEach(function(e){var t=0;for(t;t<r.KEY_USAGES.length&&r.KEY_USAGES[t].toLowerCase()!==e.toLowerCase();t++);if(t===r.KEY_USAGES.length)throw new s("Unsupported key usage '"+e+"'. Should be one of ["+r.KEY_USAGES.join(", ")+"]")})},r.generateKey=function(e,r,t){var n=this;return new Promise(function(r,o){n.checkAlgorithm(e),n.checkKeyGenParams(e),n.checkKeyGenUsages(t),r(void 0)})},r.exportKey=function(e,r){var t=this;return new Promise(function(n,o){t.checkKey(r,t.ALG_NAME),t.checkFormat(e,r.type),n(void 0)})},r.importKey=function(e,r,t,n,o){var a=this;return new Promise(function(r,n){if(a.checkImportAlgorithm(t),a.checkFormat(e),"raw"===e.toLowerCase())throw new u(u.ALLOWED_FORMAT,e,"'JsonWebKey', 'pkcs8' or 'spki'");a.checkKeyGenUsages(o),r(void 0)})},r}(h);G.ALG_NAME="",G.KEY_USAGES=[];var M=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),r.sign=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"private","sign"),t(void 0)})},r.verify=function(e,r,t,n){var o=this;return new Promise(function(t,n){o.checkAlgorithmParams(e),o.checkKey(r,o.ALG_NAME,"public","verify"),t(void 0)})},r}(G);M.ALG_NAME=p.RsaSSA,M.KEY_USAGES=["sign","verify"];var T=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=4,r}return i.__extends(r,e),r}(c),B=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),r.checkAlgorithmParams=function(r){var t=r;if(e.checkAlgorithmParams.call(this,t),!t.saltLength)throw new T(T.PARAM_REQUIRED,"saltLength");if(t.saltLength<0)throw new T("Parameter 'saltLength' is outside of numeric range")},r}(M);B.ALG_NAME=p.RsaPSS;var D=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=5,r}return i.__extends(r,e),r}(c),x=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),r.checkAlgorithmParams=function(e){if(e.label&&!(ArrayBuffer.isView(e.label)||e.label instanceof ArrayBuffer))throw new D(D.PARAM_WRONG_TYPE,"label","ArrayBufferView or ArrayBuffer")},r.encrypt=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"public","encrypt"),t(void 0)})},r.decrypt=function(e,r,t){var n=this;return new Promise(function(t,o){n.checkAlgorithmParams(e),n.checkKey(r,n.ALG_NAME,"private","decrypt"),t(void 0)})},r.wrapKey=function(e,r,t,n){var o=this;return new Promise(function(a,i){o.checkAlgorithmParams(n),o.checkKey(t,o.ALG_NAME,"public","wrapKey"),o.checkWrappedKey(r),o.checkFormat(e,r.type),a(void 0)})},r.unwrapKey=function(e,r,t,n,o,a,i){var s=this;return new Promise(function(r,o){s.checkAlgorithmParams(n),s.checkKey(t,s.ALG_NAME,"private","unwrapKey"),s.checkFormat(e),r(void 0)})},r}(G);x.ALG_NAME=p.RsaOAEP,x.KEY_USAGES=["encrypt","decrypt","wrapKey","unwrapKey"];var W=function(){function e(){}return e.prototype.generateKey=function(e,r,t){return new Promise(function(n,a){var i=o(e),s=h;switch(i.name.toUpperCase()){case p.RsaSSA.toUpperCase():s=M;break;case p.RsaOAEP.toUpperCase():s=x;break;case p.RsaPSS.toUpperCase():s=B;break;case p.AesCBC.toUpperCase():s=g;break;case p.AesCTR.toUpperCase():s=d;break;case p.AesGCM.toUpperCase():s=C;break;case p.AesKW.toUpperCase():s=_;break;case p.EcDSA.toUpperCase():s=S;break;case p.EcDH.toUpperCase():s=R;break;case p.Hmac.toUpperCase():s=L;break;default:throw new c(c.UNSUPPORTED_ALGORITHM,i.name)}s.generateKey(i,r,t).then(n,a)})},e.prototype.digest=function(e,r){return new Promise(function(t,n){var i=o(e),s=a(r,"data"),u=h;switch(i.name.toUpperCase()){case p.Sha1.toUpperCase():case p.Sha256.toUpperCase():case p.Sha384.toUpperCase():case p.Sha512.toUpperCase():u=E;break;default:throw new c(c.UNSUPPORTED_ALGORITHM,i.name)}u.digest(i,s).then(t,n)})},e.prototype.sign=function(e,r,t){return new Promise(function(n,i){var s=o(e),u=a(t,"data"),f=h;switch(s.name.toUpperCase()){case p.RsaSSA.toUpperCase():f=M;break;case p.RsaPSS.toUpperCase():f=B;break;case p.EcDSA.toUpperCase():f=S;break;case p.Hmac.toUpperCase():f=L;break;default:throw new c(c.UNSUPPORTED_ALGORITHM,s.name)}f.sign(s,r,u).then(n,i)})},e.prototype.verify=function(e,r,t,n){return new Promise(function(t,i){var s=o(e),u=a(n,"signature"),f=a(n,"data"),l=h;switch(s.name.toUpperCase()){case p.RsaSSA.toUpperCase():l=M;break;case p.RsaPSS.toUpperCase():l=B;break;case p.EcDSA.toUpperCase():l=S;break;case p.Hmac.toUpperCase():l=L;break;default:throw new c(c.UNSUPPORTED_ALGORITHM,s.name)}l.verify(s,r,u,f).then(t,i)})},e.prototype.encrypt=function(e,r,t){return new Promise(function(n,i){var s=o(e),u=a(t,"data"),f=h;switch(s.name.toUpperCase()){case p.RsaOAEP.toUpperCase():f=x;break;case p.AesCBC.toUpperCase():f=g;break;case p.AesCTR.toUpperCase():f=d;break;case p.AesGCM.toUpperCase():f=C;break;default:throw new c(c.UNSUPPORTED_ALGORITHM,s.name)}f.encrypt(s,r,u).then(n,i)})},e.prototype.decrypt=function(e,r,t){return new Promise(function(n,i){var s=o(e),u=a(t,"data"),f=h;switch(s.name.toUpperCase()){case p.RsaOAEP.toUpperCase():f=x;break;case p.AesCBC.toUpperCase():f=g;break;case p.AesCTR.toUpperCase():f=d;break;case p.AesGCM.toUpperCase():f=C;break;default:throw new c(c.UNSUPPORTED_ALGORITHM,s.name)}f.decrypt(s,r,u).then(n,i)})},e.prototype.deriveBits=function(e,r,t){return new Promise(function(n,a){var i=o(e),s=h;switch(i.name.toUpperCase()){case p.EcDH.toUpperCase():s=R;break;case p.Pbkdf2.toUpperCase():s=O;break;default:throw new c(c.UNSUPPORTED_ALGORITHM,i.name)}s.deriveBits(i,r,t).then(n,a)})},e.prototype.deriveKey=function(e,r,t,n,a){return new Promise(function(i,s){var u=o(e),f=o(t),l=h;switch(u.name.toUpperCase()){case p.EcDH.toUpperCase():l=R;break;case p.Pbkdf2.toUpperCase():l=O;break;default:throw new c(c.UNSUPPORTED_ALGORITHM,u.name)}l.deriveKey(u,r,f,n,a).then(i,s)})},e.prototype.exportKey=function(e,r){return new Promise(function(t,n){if(h.checkKey(r),!r.extractable)throw new u(u.NOT_EXTRACTABLE);var o=h;switch(r.algorithm.name.toUpperCase()){case p.RsaSSA.toUpperCase():o=M;break;case p.RsaPSS.toUpperCase():o=B;break;case p.RsaOAEP.toUpperCase():o=x;break;case p.AesCBC.toUpperCase():o=g;break;case p.AesCTR.toUpperCase():o=d;break;case p.AesGCM.toUpperCase():o=C;break;case p.AesKW.toUpperCase():o=_;break;case p.EcDSA.toUpperCase():o=S;break;case p.EcDH.toUpperCase():o=R;break;case p.Hmac.toUpperCase():o=L;break;default:throw new c(c.UNSUPPORTED_ALGORITHM,r.algorithm.name)}o.exportKey(e,r).then(t,n)})},e.prototype.importKey=function(e,r,t,n,a){return new Promise(function(i,s){var u=o(t),f=h;switch(u.name.toUpperCase()){case p.RsaSSA.toUpperCase():f=M;break;case p.RsaPSS.toUpperCase():f=B;break;case p.RsaOAEP.toUpperCase():f=x;break;case p.AesCBC.toUpperCase():f=g;break;case p.AesCTR.toUpperCase():f=d;break;case p.AesGCM.toUpperCase():f=C;break;case p.AesKW.toUpperCase():f=_;break;case p.EcDSA.toUpperCase():f=S;break;case p.EcDH.toUpperCase():f=R;break;case p.Hmac.toUpperCase():f=L;break;case p.Pbkdf2.toUpperCase():f=O;break;default:throw new c(c.UNSUPPORTED_ALGORITHM,u.name)}f.importKey(e,r,u,n,a).then(i,s)})},e.prototype.wrapKey=function(e,r,t,n){return new Promise(function(a,i){var s=o(n),u=h;switch(s.name.toUpperCase()){case p.RsaOAEP.toUpperCase():u=x;break;case p.AesCBC.toUpperCase():u=g;break;case p.AesCTR.toUpperCase():u=d;break;case p.AesGCM.toUpperCase():u=C;break;case p.AesKW.toUpperCase():u=_;break;default:throw new c(c.UNSUPPORTED_ALGORITHM,s.name)}u.wrapKey(e,r,t,s).then(a,i)})},e.prototype.unwrapKey=function(e,r,t,n,i,s,u){return new Promise(function(f,l){var y=o(n),m=o(i),w=a(r,"wrappedKey"),A=h;switch(y.name.toUpperCase()){case p.RsaOAEP.toUpperCase():A=x;break;case p.AesCBC.toUpperCase():A=g;break;case p.AesCTR.toUpperCase():A=d;break;case p.AesGCM.toUpperCase():A=C;break;case p.AesKW.toUpperCase():A=_;break;default:throw new c(c.UNSUPPORTED_ALGORITHM,y.name)}A.unwrapKey(e,w,t,y,m,s,u).then(f,l)})},e}();r.WebCryptoError=s,r.AlgorithmError=c,r.CryptoKeyError=u,r.PrepareAlgorithm=o,r.PrepareData=a,r.BaseCrypto=h,r.AlgorithmNames=p,r.Base64Url=l,r.SubtleCrypto=W,r.Aes=m,r.AesAlgorithmError=w,r.AesWrapKey=A,r.AesEncrypt=v,r.AesCBC=g,r.AesCTR=d,r.AesGCM=C,r.AesKW=_,r.RsaKeyGenParamsError=K,r.RsaHashedImportParamsError=N,r.Rsa=G,r.RsaSSA=M,r.RsaPSSParamsError=T,r.RsaPSS=B,r.RsaOAEPParamsError=D,r.RsaOAEP=x,r.EcKeyGenParamsError=b,r.Ec=k,r.EcAlgorithmError=U,r.EcDSA=S,r.EcDH=R,r.ShaAlgorithms=P,r.Sha=E}).call(r,function(){return this}())},function(e,r,t){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t(1),a=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.code=10,r}return n(r,e),r}(o.WebCryptoError);a.MODULE_NOT_FOUND="Module '%1' is not found. Download it from %2",a.UNSUPPORTED_ALGORITHM="Unsupported algorithm '%1'",r.LinerError=a},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(12),o=t(5),a=function(){function e(){this.subtle=new n.SubtleCrypto}return e.prototype.getRandomValues=function(e){return o.nativeCrypto.getRandomValues(e)},e}();r.Crypto=a},function(e,r){"use strict";function t(){var e,t={name:"",version:""},n=self.navigator.userAgent;return(e=/edge\/([\d\.]+)/i.exec(n))?(t.name=r.Browser.Edge,t.version=e[1]):/msie/i.test(n)?(t.name=r.Browser.IE,t.version=/msie ([\d\.]+)/i.exec(n)[1]):/Trident/i.test(n)?(t.name=r.Browser.IE,t.version=/rv:([\d\.]+)/i.exec(n)[1]):/chrome/i.test(n)?(t.name=r.Browser.Chrome,t.version=/chrome\/([\d\.]+)/i.exec(n)[1]):/safari/i.test(n)?(t.name=r.Browser.Safari,t.version=/([\d\.]+) safari/i.exec(n)[1]):/firefox/i.test(n)&&(t.name=r.Browser.Firefox,t.version=/firefox\/([\d\.]+)/i.exec(n)[1]),t}function n(e){for(var r=new Uint8Array(e.length),t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r}function o(e){for(var r="",t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return r}function a(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=new Uint8Array(e.map(function(e){return e.length}).reduce(function(e,r){return e+r})),n=0;return e.forEach(function(e,r){for(var o=0;o<e.length;o++)t[n+o]=e[o];n+=e.length}),t}function i(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(var n=arguments[0],o=1;o<arguments.length;o++){var a=arguments[o];for(var i in a)n[i]=a[i]}return n}Object.defineProperty(r,"__esModule",{value:!0}),r.Browser={IE:"Internet Explorer",Safari:"Safari",Edge:"Edge",Chrome:"Chrome",Firefox:"Firefox Mozilla"},r.BrowserInfo=t,r.string2buffer=n,r.buffer2string=o,r.concat=a,r.assign=i},function(e,r,t){"use strict";function n(e,r){var t=e[r];e[r]=function(){var n=arguments;return new Promise(function(o,a){var i=t.apply(e,n);i.oncomplete=function(e){console.log("Completed"),o(e.target.result)},i.onerror=function(e){console.log("Error"),a("Error on running '"+r+"' function")}})}}Object.defineProperty(r,"__esModule",{value:!0});var o,a=t(2);if("undefined"==typeof self){var i=t(14);o={crypto:{subtle:{},getRandomValues:function(e){var r=e.buffer,t=new Uint8Array(r),n=i.randomBytes(t.length);return n.forEach(function(e,r){return t[r]=e}),e}}}}else o=self;if(r.nativeCrypto=o.msCrypto||o.crypto,r.nativeSubtle=r.nativeCrypto.subtle||r.nativeCrypto.webkitSubtle,o.msCrypto){if(!o.Promise)throw new a.LinerError(a.LinerError.MODULE_NOT_FOUND,"Promise","https://www.promisejs.org");n(r.nativeSubtle,"generateKey"),n(r.nativeSubtle,"digest"),n(r.nativeSubtle,"sign"),n(r.nativeSubtle,"verify"),n(r.nativeSubtle,"encrypt"),n(r.nativeSubtle,"decrypt"),n(r.nativeSubtle,"importKey"),n(r.nativeSubtle,"exportKey"),n(r.nativeSubtle,"wrapKey"),n(r.nativeSubtle,"unwrapKey"),n(r.nativeSubtle,"deriveKey"),n(r.nativeSubtle,"deriveBits")}Math.imul||(Math.imul=function(e,r){var t=e>>>16&65535,n=65535&e,o=r>>>16&65535,a=65535&r;return n*a+(t*a+n*o<<16>>>0)|0})},function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=function(){function e(){}return e}();r.CryptoKey=t},function(e,r,t){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t(1),a=t(2),i=t(6),s=t(4),c=t(5),u=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n(r,e),r.generateKey=function(e,r,t){var n=this;return Promise.resolve().then(function(){n.checkModule();var o=c.nativeCrypto.getRandomValues(new Uint8Array(e.length/8)),a=new i.CryptoKey;return a.key=o,a.algorithm=e,a.extractable=r,a.type="secret",a.usages=t,a})},r.encrypt=function(e,r,t){return Promise.resolve().then(function(){var n;switch(e.name.toUpperCase()){case o.AlgorithmNames.AesCBC:var i=e;n=asmCrypto.AES_CBC.encrypt(t,r.key,void 0,o.PrepareData(i.iv,"iv"));break;case o.AlgorithmNames.AesGCM:var s=e;s.tagLength=s.tagLength||128;
var c=void 0;s.additionalData&&(c=o.PrepareData(s.additionalData,"additionalData")),n=asmCrypto.AES_GCM.encrypt(t,r.key,s.iv,c,s.tagLength/8);break;default:throw new a.LinerError(o.AlgorithmError.UNSUPPORTED_ALGORITHM,e.name)}return n.buffer})},r.decrypt=function(e,r,t){return Promise.resolve().then(function(){var n;switch(e.name.toUpperCase()){case o.AlgorithmNames.AesCBC:var i=e;n=asmCrypto.AES_CBC.decrypt(t,r.key,void 0,o.PrepareData(i.iv,"iv"));break;case o.AlgorithmNames.AesGCM:var s=e;s.tagLength=s.tagLength||128;var c=void 0;s.additionalData&&(c=o.PrepareData(s.additionalData,"additionalData")),n=asmCrypto.AES_GCM.decrypt(t,r.key,s.iv,c,s.tagLength/8);break;default:throw new a.LinerError(o.AlgorithmError.UNSUPPORTED_ALGORITHM,e.name)}return n.buffer})},r.wrapKey=function(e,r,t,n){var o;return Promise.resolve().then(function(){return o=new h.Crypto,o.subtle.exportKey(e,r)}).then(function(e){var r;return r=e instanceof ArrayBuffer?new Uint8Array(e):s.string2buffer(JSON.stringify(e)),o.subtle.encrypt(n,t,r)})},r.unwrapKey=function(e,r,t,n,o,a,i){var c;return Promise.resolve().then(function(){return c=new h.Crypto,c.subtle.decrypt(n,t,r)}).then(function(r){var t;return t="jwk"===e.toLowerCase()?JSON.parse(s.buffer2string(new Uint8Array(r))):new Uint8Array(r),c.subtle.importKey(e,t,o,a,i)})},r.alg2jwk=function(e){return"A"+e.length+/-(\w+)/i.exec(e.name.toUpperCase())[1]},r.jwk2alg=function(e){throw new Error("Not implemented")},r.exportKey=function(e,r){var t=this;return Promise.resolve().then(function(){var n=r.key;if("jwk"===e.toLowerCase()){var a={alg:t.alg2jwk(r.algorithm),ext:r.extractable,k:o.Base64Url.encode(n),key_ops:r.usages,kty:"oct"};return a}return n.buffer})},r.importKey=function(e,r,t,n,a){return Promise.resolve().then(function(){var n;if("jwk"===e.toLowerCase()){var s=r;n=o.Base64Url.decode(s.k)}else n=new Uint8Array(r);var c=new i.CryptoKey;return c.algorithm=t,c.type="secret",c.usages=a,c.key=n,c})},r.checkModule=function(){if("undefined"==typeof asmCrypto)throw new a.LinerError(a.LinerError.MODULE_NOT_FOUND,"asmCrypto","https://github.com/vibornoff/asmcrypto.js")},r}(o.BaseCrypto);r.AesCrypto=u;var h=t(3)},function(e,r,t){"use strict";function n(e){for(var r=new Uint8Array(e),t=[],n=0;n<r.length;n++)t.push(r[n]);return t}function o(e,r){e.length%2&&(e="0"+e);for(var t=new Uint8Array(e.length/2),n=0;n<e.length;n++){var o=e.slice(n,++n+1);t[(n-1)/2]=parseInt(o,16)}if(r){var a=t.length;a=a>32?a>48?66:48:32,t.length<a&&(t=h.concat(new Uint8Array(a-t.length),t))}return t}function a(e,r){for(var t="",n=0;n<e.length;n++){var o=e[n].toString(16);t+=o.length%2?"0"+o:o}if(r){var a=e.length;a=a>32?a>48?66:48:32,t.length/2<a&&(t=new Array(2*a-t.length+1).join("0")+t)}return t}var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var s=t(1),c=t(2),u=t(6),h=t(4),p=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i(r,e),r.generateKey=function(e,r,t){var n=this;return Promise.resolve().then(function(){n.checkModule();var t=e,o=new elliptic.ec(t.namedCurve.replace("-","").toLowerCase()),a=new u.CryptoKey,i=new u.CryptoKey;return a.key=i.key=o.genKeyPair(),a.algorithm=i.algorithm=t,a.extractable=r,i.extractable=!0,a.type="private",i.type="public",e.name===s.AlgorithmNames.EcDSA?(a.usages=["sign"],i.usages=["verify"]):e.name===s.AlgorithmNames.EcDH&&(a.usages=["deriveKey","deriveBits"],i.usages=[]),{privateKey:a,publicKey:i}})},r.sign=function(e,r,t){return Promise.resolve().then(function(){var r=e,n=new f.Crypto;return n.subtle.digest(r.hash,t)}).then(function(e){var t=n(e),i=r.key.sign(t),s=a(i.r.toArray(),!0)+a(i.s.toArray(),!0);return o(s).buffer})},r.verify=function(e,r,t,o){var a;return Promise.resolve().then(function(){var r=e;a={r:t.slice(0,t.byteLength/2),s:t.slice(t.byteLength/2)};var n=new f.Crypto;return n.subtle.digest(r.hash,o)}).then(function(e){var t=n(e);return r.key.verify(t,a)})},r.deriveKey=function(e,r,t,n,o){var a=this;return Promise.resolve().then(function(){return a.deriveBits(e,r,t.length)}).then(function(e){var r=new f.Crypto;return r.subtle.importKey("raw",new Uint8Array(e),t,n,o)})},r.deriveBits=function(e,r,t){return Promise.resolve().then(function(){var n=(Promise.resolve(null),r.key.derive(e.public.key.getPublic())),o=new Uint8Array(n.toArray()),a=o.length;a=a>32?a>48?66:48:32,o.length<a&&(o=h.concat(new Uint8Array(a-o.length),o));var i=o.slice(0,t/8).buffer;return i})},r.exportKey=function(e,r){return Promise.resolve().then(function(){var t=r.key;if("jwk"===e.toLowerCase()){var n=t.getPublic("hex").slice(2),a=n.slice(0,n.length/2),i=n.slice(n.length/2,n.length);if("public"===r.type){var u={crv:r.algorithm.namedCurve,ext:r.extractable,x:s.Base64Url.encode(o(a,!0)),y:s.Base64Url.encode(o(i,!0)),key_ops:r.usages,kty:"EC"};return u}var u={crv:r.algorithm.namedCurve,ext:r.extractable,d:s.Base64Url.encode(o(t.getPrivate("hex"),!0)),x:s.Base64Url.encode(o(a,!0)),y:s.Base64Url.encode(o(i,!0)),key_ops:r.usages,kty:"EC"};return u}throw new c.LinerError("Format '"+e+"' is not implemented")})},r.importKey=function(e,r,t,n,o){return Promise.resolve().then(function(){var i=new u.CryptoKey;if(i.algorithm=t,"jwk"!==e.toLowerCase())throw new c.LinerError("Format '"+e+"' is not implemented");var p=new elliptic.ec(r.crv.replace("-","").toLowerCase());if(r.d)i.key=p.keyFromPrivate(s.Base64Url.decode(r.d)),i.type="private";else{var f=h.concat(new Uint8Array([4]),s.Base64Url.decode(r.x),s.Base64Url.decode(r.y)),l=a(f);i.key=p.keyFromPublic(l,"hex"),i.type="public"}return i.extractable=n,i.usages=o,i})},r.checkModule=function(){if("undefined"==typeof elliptic)throw new c.LinerError(c.LinerError.MODULE_NOT_FOUND,"elliptic","https://github.com/indutny/elliptic")},r}(s.BaseCrypto);r.EcCrypto=p;var f=t(3)},function(e,r,t){"use strict";function n(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),n(t(5)),n(t(3))},function(e,r,t){"use strict";function n(e){var r=!0;return e.filter(function(e){return(!r||0!==e)&&(r=!1,!0)})}var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var a=t(1),i=t(2),s=t(4),c=t(6),u=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return o(r,e),r.generateKey=function(e,r,t){var n=this;return Promise.resolve().then(function(){n.checkModule();var o=3===e.publicExponent[0]?3:65537,s=asmCrypto.RSA.generateKey(e.modulusLength,o),u=new c.CryptoKey,h=new c.CryptoKey;switch(u.key=h.key=s,u.algorithm=h.algorithm=e,u.extractable=r,h.extractable=!0,u.type="private",h.type="public",e.name.toLowerCase()){case a.AlgorithmNames.RsaOAEP.toLowerCase():u.usages=n.filterUsages(["decrypt","unwrapKey"],t),h.usages=n.filterUsages(["encrypt","wrapKey"],t);break;case a.AlgorithmNames.RsaSSA.toLowerCase():case a.AlgorithmNames.RsaPSS.toLowerCase():u.usages=n.filterUsages(["sign"],t),h.usages=n.filterUsages(["verify"],t);break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,e.name)}return{privateKey:u,publicKey:h}})},r.sign=function(e,r,t){return Promise.resolve().then(function(){switch(e.name.toLowerCase()){case a.AlgorithmNames.RsaSSA.toLowerCase():var n=r.algorithm,o=e,s=void 0;switch(n.hash.name.toUpperCase()){case a.AlgorithmNames.Sha1:s=asmCrypto.RSA_PKCS1_v1_5_SHA1.sign;break;case a.AlgorithmNames.Sha256:s=asmCrypto.RSA_PKCS1_v1_5_SHA256.sign;break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,r.algorithm.name)}return s(t,r.key).buffer;case a.AlgorithmNames.RsaPSS.toLowerCase():var n=r.algorithm,o=e,s=void 0;switch(n.hash.name.toUpperCase()){case a.AlgorithmNames.Sha1:s=asmCrypto.RSA_PSS_SHA1.sign;break;case a.AlgorithmNames.Sha256:s=asmCrypto.RSA_PSS_SHA256.sign;break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,r.algorithm.name)}return s(t,r.key,o.saltLength).buffer;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,e.name)}})},r.verify=function(e,r,t,n){return Promise.resolve().then(function(){switch(e.name.toLowerCase()){case a.AlgorithmNames.RsaSSA.toLowerCase():var o,s=r.algorithm;switch(s.hash.name.toUpperCase()){case a.AlgorithmNames.Sha1:o=asmCrypto.RSA_PKCS1_v1_5_SHA1.verify;break;case a.AlgorithmNames.Sha256:o=asmCrypto.RSA_PKCS1_v1_5_SHA256.verify;break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,r.algorithm.name)}try{return o(t,n,r.key)}catch(e){return console.warn("Verify error: "+e.message),!1}case a.AlgorithmNames.RsaPSS.toLowerCase():var c=r.algorithm,u=e,h=void 0;switch(c.hash.name.toUpperCase()){case a.AlgorithmNames.Sha1:h=asmCrypto.RSA_PSS_SHA1.verify;break;case a.AlgorithmNames.Sha256:h=asmCrypto.RSA_PSS_SHA256.verify;break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,r.algorithm.name)}try{return h(t,n,r.key,u.saltLength)}catch(e){return console.warn("Verify error: "+e.message),!1}default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,e.name)}})},r.encrypt=function(e,r,t){return Promise.resolve().then(function(){switch(e.name.toLowerCase()){case a.AlgorithmNames.RsaOAEP.toLowerCase():var n=r.algorithm,o=e,s=void 0;switch(n.hash.name.toUpperCase()){case a.AlgorithmNames.Sha1:s=asmCrypto.RSA_OAEP_SHA1.encrypt;break;case a.AlgorithmNames.Sha256:s=asmCrypto.RSA_OAEP_SHA256.encrypt;break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,n.name+" "+n.hash.name)}var c=void 0;return o.label&&(c=a.PrepareData(o.label,"label")),s(t,r.key,c);default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,e.name)}})},r.decrypt=function(e,r,t){return Promise.resolve().then(function(){switch(e.name.toLowerCase()){case a.AlgorithmNames.RsaOAEP.toLowerCase():var n=r.algorithm,o=e,s=void 0;switch(n.hash.name.toUpperCase()){case a.AlgorithmNames.Sha1:s=asmCrypto.RSA_OAEP_SHA1.decrypt;break;case a.AlgorithmNames.Sha256:s=asmCrypto.RSA_OAEP_SHA256.decrypt;break;default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,n.name+" "+n.hash.name)}var c=void 0;return o.label&&(c=a.PrepareData(o.label,"label")),s(t,r.key,c);default:throw new i.LinerError(i.LinerError.UNSUPPORTED_ALGORITHM,e.name)}})},r.wrapKey=function(e,r,t,n){var o;return Promise.resolve().then(function(){return o=new h.Crypto,o.subtle.exportKey(e,r)}).then(function(e){var r;return r=e instanceof ArrayBuffer?new Uint8Array(e):s.string2buffer(JSON.stringify(e)),o.subtle.encrypt(n,t,r)})},r.unwrapKey=function(e,r,t,n,o,a,i){var c;return Promise.resolve().then(function(){return c=new h.Crypto,c.subtle.decrypt(n,t,r)}).then(function(r){var t;return t="jwk"===e.toLowerCase()?JSON.parse(s.buffer2string(new Uint8Array(r))):new Uint8Array(r),c.subtle.importKey(e,t,o,a,i)})},r.alg2jwk=function(e){var r=e.hash,t=/(\d+)/.exec(r.name)[1];switch(e.name.toUpperCase()){case a.AlgorithmNames.RsaOAEP.toUpperCase():return"RSA-OAEP"+("1"===t?"":"-"+t);case a.AlgorithmNames.RsaPSS.toUpperCase():return"PS"+t;case a.AlgorithmNames.RsaSSA.toUpperCase():return"RS"+t;default:throw new a.AlgorithmError(a.AlgorithmError.UNSUPPORTED_ALGORITHM,e.name)}},r.jwk2alg=function(e){throw new Error("Not implemented")},r.exportKey=function(e,r){var t=this;return Promise.resolve().then(function(){if("jwk"===e.toLowerCase()){var o={kty:"RSA",ext:!0,key_ops:r.usages};return o.alg=t.alg2jwk(r.algorithm),o.n=a.Base64Url.encode(n(r.key[0])),o.e=a.Base64Url.encode(n(r.key[1])),"private"===r.type&&(o.d=a.Base64Url.encode(n(r.key[2])),o.p=a.Base64Url.encode(n(r.key[3])),o.q=a.Base64Url.encode(n(r.key[4])),o.dp=a.Base64Url.encode(n(r.key[5])),o.dq=a.Base64Url.encode(n(r.key[6])),o.qi=a.Base64Url.encode(n(r.key[7]))),o}throw new i.LinerError(i.LinerError.NOT_SUPPORTED)})},r.importKey=function(e,r,t,n,o){return Promise.resolve().then(function(){var n,s=new c.CryptoKey;if(s.algorithm=t,s.usages=o,s.key=[],"jwk"===e.toLowerCase())return n=r,s.key[0]=a.Base64Url.decode(n.n),s.key[1]=3===a.Base64Url.decode(n.e)[0]?new Uint8Array([0,0,0,3]):new Uint8Array([0,1,0,1]),n.d?(s.type="private",s.key[2]=a.Base64Url.decode(n.d),s.key[3]=a.Base64Url.decode(n.p),s.key[4]=a.Base64Url.decode(n.q),s.key[5]=a.Base64Url.decode(n.dp),s.key[6]=a.Base64Url.decode(n.dq),s.key[7]=a.Base64Url.decode(n.qi)):s.type="public",s;throw new i.LinerError(i.LinerError.NOT_SUPPORTED)})},r.checkModule=function(){if("undefined"==typeof asmCrypto)throw new i.LinerError(i.LinerError.MODULE_NOT_FOUND,"asmCrypto","https://github.com/vibornoff/asmcrypto.js")},r.filterUsages=function(e,r){return e.filter(function(e){return!!r.filter(function(r){return e===r}).length})},r}(a.BaseCrypto);r.RsaCrypto=u;var h=t(3)},function(e,r,t){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t(1),a=t(2),i=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n(r,e),r.digest=function(e,r){return Promise.resolve().then(function(){if("undefined"==typeof asmCrypto)throw new a.LinerError(a.LinerError.MODULE_NOT_FOUND,"asmCrypto","https://github.com/vibornoff/asmcrypto.js");switch(e.name.toUpperCase()){case o.AlgorithmNames.Sha1:return asmCrypto.SHA1.bytes(r).buffer;case o.AlgorithmNames.Sha256:return asmCrypto.SHA256.bytes(r).buffer;default:throw new a.LinerError("Not supported algorithm '"+e.name+"'")}})},r}(o.BaseCrypto);r.ShaCrypto=i},function(e,r,t){"use strict";function n(e,r){return Promise.resolve().then(function(){if(e.key)return e;if(e.extractable){var t=new y.Crypto;return t.subtle.exportKey("jwk",e).then(function(t){var n=a(e);return n&&(n=w.assign(n,e.algorithm)),r.importKey("jwk",t,n,!0,e.usages)})}throw new m.LinerError("'key' is Native CryptoKey. It can't be converted to JS CryptoKey")})}function o(e,r){w.BrowserInfo().name!==w.Browser.IE&&w.BrowserInfo().name!==w.Browser.Edge&&w.BrowserInfo().name!==w.Browser.Safari||!/^rsa/i.test(e.name)||(r.privateKey?(C.push({hash:e.hash,key:r.privateKey}),C.push({hash:e.hash,key:r.publicKey})):C.push({hash:e.hash,key:r}))}function a(e){var r=null;return C.some(function(t){return t.key===e&&(r=w.assign({},e.algorithm,{hash:t.hash}),!0)}),r}function i(e,r){var t=[];e.privateKey?(t.push(e.privateKey),t.push(e.publicKey)):t.push(e),t.forEach(function(e){"keyUsage"in e&&(e.usages=e.keyUsage||[],e.usages.length||(["verify","encrypt","wrapKey"].forEach(function(t){r.indexOf(t)>-1&&("public"===e.type||"secret"===e.type)&&e.usages.push(t)}),["sign","decrypt","unwrapKey","deriveKey","deriveBits"].forEach(function(t){r.indexOf(t)>-1&&("private"===e.type||"secret"===e.type)&&e.usages.push(t)})))})}function s(e,r,t){if(r&&w.BrowserInfo().name===w.Browser.IE){"extractable"in e&&(e.ext=e.extractable,delete e.extractable);var n=null;switch(r.name.toUpperCase()){case h.AlgorithmNames.RsaOAEP.toUpperCase():case h.AlgorithmNames.RsaPSS.toUpperCase():case h.AlgorithmNames.RsaSSA.toUpperCase():n=g.RsaCrypto;break;case h.AlgorithmNames.AesCBC.toUpperCase():case h.AlgorithmNames.AesGCM.toUpperCase():n=A.AesCrypto;break;default:throw new m.LinerError(m.LinerError.UNSUPPORTED_ALGORITHM,r.name.toUpperCase())}n&&!e.alg&&(e.alg=n.alg2jwk(r)),"key_ops"in e||(e.key_ops=t)}}function c(e){w.BrowserInfo().name===w.Browser.IE&&("ext"in e&&(e.extractable=e.ext,delete e.ext),delete e.key_ops,delete e.alg)}var u=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var h=t(1),p=t(1),f=t(1),l=t(5),y=t(3),m=t(2),w=t(4),A=t(7),v=t(11),g=t(10),d=t(8),C=[],_=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return u(r,e),r.prototype.generateKey=function(r,t,n){var a,s=arguments;return e.prototype.generateKey.apply(this,s).then(function(e){a=f.PrepareAlgorithm(r);try{return l.nativeSubtle.generateKey.apply(l.nativeSubtle,s).catch(function(e){console.warn("WebCrypto: native generateKey for "+a.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native generateKey for "+a.name+" doesn't work.",e.message||"")}}).then(function(e){if(e)return i(e,n),o(a,e),e;var r;switch(a.name.toLowerCase()){case h.AlgorithmNames.AesCBC.toLowerCase():case h.AlgorithmNames.AesGCM.toLowerCase():r=A.AesCrypto;break;case h.AlgorithmNames.EcDSA.toLowerCase():case h.AlgorithmNames.EcDH.toLowerCase():r=d.EcCrypto;break;case h.AlgorithmNames.RsaOAEP.toLowerCase():case h.AlgorithmNames.RsaPSS.toLowerCase():case h.AlgorithmNames.RsaSSA.toLowerCase():r=g.RsaCrypto;break;default:throw new m.LinerError(m.LinerError.UNSUPPORTED_ALGORITHM,a.name.toLowerCase())}return r.generateKey(a,t,n)})},r.prototype.digest=function(r,t){var n,o,a=arguments;return e.prototype.digest.apply(this,a).then(function(e){n=f.PrepareAlgorithm(r),o=f.PrepareData(t,"data");try{return l.nativeSubtle.digest.apply(l.nativeSubtle,a).catch(function(e){console.warn("WebCrypto: native digest for "+n.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native digest for "+n.name+" doesn't work.",e.message||"")}}).then(function(e){return e?e:v.ShaCrypto.digest(n,o)})},r.prototype.sign=function(r,t,o){var i,s,c=arguments;return e.prototype.sign.apply(this,c).then(function(e){i=f.PrepareAlgorithm(r),s=f.PrepareData(o,"data");var n=a(t);n&&(c[0]=w.assign(i,n));try{return l.nativeSubtle.sign.apply(l.nativeSubtle,c).catch(function(e){console.warn("WebCrypto: native sign for "+i.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native sign for "+i.name+" doesn't work.",e.message||"")}}).then(function(e){if(e)return e;var r;switch(i.name.toLowerCase()){case h.AlgorithmNames.EcDSA.toLowerCase():r=d.EcCrypto;break;case h.AlgorithmNames.RsaSSA.toLowerCase():case h.AlgorithmNames.RsaPSS.toLowerCase():r=g.RsaCrypto;break;default:throw new m.LinerError(m.LinerError.UNSUPPORTED_ALGORITHM,i.name.toLowerCase())}return n(t,r).then(function(e){return r.sign(i,e,s)})})},r.prototype.verify=function(r,t,o,i){var s,c,u,p=arguments;return e.prototype.verify.apply(this,p).then(function(e){s=f.PrepareAlgorithm(r),c=f.PrepareData(o,"data"),u=f.PrepareData(i,"data");var n=a(t);n&&(p[0]=w.assign(s,n));try{return l.nativeSubtle.verify.apply(l.nativeSubtle,p).catch(function(e){console.warn("WebCrypto: native verify for "+s.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native verify for "+s.name+" doesn't work.",e.message||"")}}).then(function(e){if("boolean"==typeof e)return e;var r;switch(s.name.toLowerCase()){case h.AlgorithmNames.EcDSA.toLowerCase():r=d.EcCrypto;break;case h.AlgorithmNames.RsaSSA.toLowerCase():case h.AlgorithmNames.RsaPSS.toLowerCase():r=g.RsaCrypto;break;default:throw new m.LinerError(m.LinerError.UNSUPPORTED_ALGORITHM,s.name.toLowerCase())}return n(t,r).then(function(e){return r.verify(s,e,c,u)})})},r.prototype.deriveBits=function(r,t,n){var o,a=arguments;return e.prototype.deriveBits.apply(this,a).then(function(e){o=f.PrepareAlgorithm(r);try{return l.nativeSubtle.deriveBits.apply(l.nativeSubtle,a).catch(function(e){console.warn("WebCrypto: native deriveBits for "+o.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native deriveBits for "+o.name+" doesn't work.",e.message||"")}}).then(function(e){if(e)return e;var r;switch(o.name.toLowerCase()){case h.AlgorithmNames.EcDH.toLowerCase():r=d.EcCrypto;break;default:throw new m.LinerError(m.LinerError.NOT_SUPPORTED,"deriveBits")}return r.deriveBits(o,t,n)})},r.prototype.deriveKey=function(r,t,n,o,a){var s,c,u=arguments;return e.prototype.deriveKey.apply(this,u).then(function(e){s=f.PrepareAlgorithm(r),c=f.PrepareAlgorithm(n);try{return l.nativeSubtle.deriveKey.apply(l.nativeSubtle,u).catch(function(e){console.warn("WebCrypto: native deriveKey for "+s.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native deriveKey for "+s.name+" doesn't work.",e.message||"")}}).then(function(e){if(e)return i(e,a),e;var r;switch(s.name.toLowerCase()){case h.AlgorithmNames.EcDH.toLowerCase():r=d.EcCrypto;break;default:throw new m.LinerError(m.LinerError.NOT_SUPPORTED,"deriveBits")}return r.deriveKey(s,t,c,o,a)})},r.prototype.encrypt=function(r,t,o){var a,i,s=arguments;return e.prototype.encrypt.apply(this,s).then(function(e){a=f.PrepareAlgorithm(r),i=f.PrepareData(o,"data");try{return l.nativeSubtle.encrypt.apply(l.nativeSubtle,s).catch(function(e){console.warn("WebCrypto: native 'encrypt' for "+a.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native 'encrypt' for "+a.name+" doesn't work.",e.message||"")}}).then(function(e){if(e){if(w.BrowserInfo().name===w.Browser.IE&&a.name.toUpperCase()===h.AlgorithmNames.AesGCM&&e.ciphertext){var r=new Uint8Array(e.ciphertext.byteLength+e.tag.byteLength),o=0;new Uint8Array(e.ciphertext).forEach(function(e){return r[o++]=e}),new Uint8Array(e.tag).forEach(function(e){return r[o++]=e}),e=r.buffer}return Promise.resolve(e)}var s;switch(a.name.toLowerCase()){case h.AlgorithmNames.AesCBC.toLowerCase():case h.AlgorithmNames.AesGCM.toLowerCase():s=A.AesCrypto;break;case h.AlgorithmNames.RsaOAEP.toLowerCase():s=g.RsaCrypto;break;default:throw new m.LinerError(m.LinerError.NOT_SUPPORTED,"encrypt")}return n(t,s).then(function(e){return s.encrypt(a,e,i)})})},r.prototype.decrypt=function(r,t,n){var o,a,i=arguments;return e.prototype.decrypt.apply(this,i).then(function(e){o=f.PrepareAlgorithm(r),a=f.PrepareData(n,"data");var i=a;if(w.BrowserInfo().name===w.Browser.IE&&o.name.toUpperCase()===h.AlgorithmNames.AesGCM){var s=a.byteLength-o.tagLength/8;i={ciphertext:a.buffer.slice(0,s),tag:a.buffer.slice(s,a.byteLength)}}if(t.key){var c=void 0;switch(o.name.toLowerCase()){case h.AlgorithmNames.AesCBC.toLowerCase():case h.AlgorithmNames.AesGCM.toLowerCase():c=A.AesCrypto;break;case h.AlgorithmNames.RsaOAEP.toLowerCase():c=g.RsaCrypto;break;default:throw new m.LinerError(m.LinerError.NOT_SUPPORTED,"decrypt")}return c.decrypt(o,t,a)}return l.nativeSubtle.decrypt.call(l.nativeSubtle,o,t,i)})},r.prototype.wrapKey=function(r,t,n,o){var a,i=arguments;return e.prototype.wrapKey.apply(this,i).then(function(e){a=f.PrepareAlgorithm(o);try{return l.nativeSubtle.wrapKey.apply(l.nativeSubtle,i).catch(function(e){console.warn("WebCrypto: native 'wrapKey' for "+a.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native 'wrapKey' for "+a.name+" doesn't work.",e.message||"")}}).then(function(e){if(e)return e;var o;switch(a.name.toLowerCase()){case h.AlgorithmNames.AesCBC.toLowerCase():case h.AlgorithmNames.AesGCM.toLowerCase():o=A.AesCrypto;break;case h.AlgorithmNames.RsaOAEP.toLowerCase():o=g.RsaCrypto;break;default:throw new m.LinerError(m.LinerError.NOT_SUPPORTED,"wrapKey")}return o.wrapKey(r,t,n,a)})},r.prototype.unwrapKey=function(r,t,n,o,a,s,c){var u,p,y,w=arguments;return e.prototype.unwrapKey.apply(this,w).then(function(e){if(u=f.PrepareAlgorithm(o),p=f.PrepareAlgorithm(a),y=f.PrepareData(t,"wrappedKey"),n.key){var v=void 0;switch(u.name.toLowerCase()){case h.AlgorithmNames.AesCBC.toLowerCase():case h.AlgorithmNames.AesGCM.toLowerCase():v=A.AesCrypto;break;case h.AlgorithmNames.RsaOAEP.toLowerCase():v=g.RsaCrypto;break;default:throw new m.LinerError(m.LinerError.NOT_SUPPORTED,"unwrapKey")}return v.unwrapKey(r,y,n,u,p,s,c)}return l.nativeSubtle.unwrapKey.apply(l.nativeSubtle,w).then(function(e){if(e)return i(e,c),e})})},r.prototype.exportKey=function(r,t){var n=arguments;return e.prototype.exportKey.apply(this,n).then(function(){try{return l.nativeSubtle.exportKey.apply(l.nativeSubtle,n).catch(function(e){console.warn("WebCrypto: native 'exportKey' for "+t.algorithm.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native 'exportKey' for "+t.algorithm.name+" doesn't work.",e.message||"")}}).then(function(e){if(e){"jwk"===r&&e instanceof ArrayBuffer&&(e=w.buffer2string(new Uint8Array(e)),e=JSON.parse(e));var n=a(t);return n||(n=w.assign({},t.algorithm)),s(e,n,t.usages),Promise.resolve(e)}if(!t.key)throw new m.LinerError("Cannot export native CryptoKey from JS implementation");var o;switch(t.algorithm.name.toLowerCase()){case h.AlgorithmNames.AesCBC.toLowerCase():case h.AlgorithmNames.AesGCM.toLowerCase():o=A.AesCrypto;break;case h.AlgorithmNames.EcDH.toLowerCase():case h.AlgorithmNames.EcDSA.toLowerCase():o=d.EcCrypto;break;case h.AlgorithmNames.RsaSSA.toLowerCase():case h.AlgorithmNames.RsaPSS.toLowerCase():case h.AlgorithmNames.RsaOAEP.toLowerCase():o=g.RsaCrypto;break;default:throw new m.LinerError(m.LinerError.UNSUPPORTED_ALGORITHM,t.algorithm.name.toLowerCase())}return o.exportKey(r,t)})},r.prototype.importKey=function(r,t,n,a,s){var u,p,y=arguments;return e.prototype.importKey.apply(this,y).then(function(e){u=f.PrepareAlgorithm(n),p=t,w.BrowserInfo().name!==w.Browser.Safari&&w.BrowserInfo().name!==w.Browser.IE||(w.BrowserInfo().name===w.Browser.IE&&(t=w.assign({},t),c(t)),y[1]=w.string2buffer(JSON.stringify(t)).buffer),ArrayBuffer.isView(t)&&(p=f.PrepareData(t,"keyData"));try{return l.nativeSubtle.importKey.apply(l.nativeSubtle,y).catch(function(e){console.warn("WebCrypto: native 'importKey' for "+u.name+" doesn't work.",e.message||"")})}catch(e){console.warn("WebCrypto: native 'importKey' for "+u.name+" doesn't work.",e.message||"")}}).then(function(e){if(e)return o(u,e),i(e,s),Promise.resolve(e);var t;switch(u.name.toLowerCase()){case h.AlgorithmNames.AesCBC.toLowerCase():case h.AlgorithmNames.AesGCM.toLowerCase():t=A.AesCrypto;break;case h.AlgorithmNames.EcDH.toLowerCase():case h.AlgorithmNames.EcDSA.toLowerCase():t=d.EcCrypto;break;case h.AlgorithmNames.RsaSSA.toLowerCase():case h.AlgorithmNames.RsaPSS.toLowerCase():case h.AlgorithmNames.RsaOAEP.toLowerCase():t=g.RsaCrypto;break;default:throw new m.LinerError(m.LinerError.UNSUPPORTED_ALGORITHM,u.name.toLowerCase())}return t.importKey(r,p,u,a,s)})},r}(p.SubtleCrypto);r.SubtleCrypto=_,Uint8Array.prototype.forEach||(Uint8Array.prototype.forEach=function(e){for(var r=0;r<this.length;r++)e(this[r],r,this)}),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(e,r){return new Uint8Array(this.buffer.slice(e,r))}),Uint8Array.prototype.filter||(Uint8Array.prototype.filter=function(e){for(var r=[],t=0;t<this.length;t++)e(this[t],t,this)&&r.push(this[t]);return new Uint8Array(r)})},function(e,r,t){var n,o;(function(t){/*! *****************************************************************************
	Copyright (c) Microsoft Corporation. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0
	
	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.
	
	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */
var a,i,s,c,u,h,p,f,l,y,m,w,A,v,g;!function(a){function i(e,r){return function(t,n){return e[t]=r?r(t,n):n}}var s="object"==typeof t?t:"object"==typeof self?self:"object"==typeof this?this:{};n=[r],o=function(e){a(i(s,i(e)))}.apply(r,n),!(void 0!==o&&(e.exports=o))}(function(e){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};a=function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++){r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},s=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)r.indexOf(n[o])<0&&(t[n[o]]=e[n[o]]);return t},c=function(e,r,t,n){var o,a=arguments.length,i=a<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,r,t,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(r,t,i):o(r,t))||i);return a>3&&i&&Object.defineProperty(r,t,i),i},u=function(e,r){return function(t,n){r(t,n,e)}},h=function(e,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,r)},p=function(e,r,t,n){return new(t||(t=Promise))(function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new t(function(r){r(e.value)}).then(i,s)}c((n=n.apply(e,r||[])).next())})},f=function(e,r){function t(e){return function(r){return n([e,r])}}function n(t){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,a&&(i=a[2&t[0]?"return":t[0]?"throw":"next"])&&!(i=i.call(a,t[1])).done)return i;switch(a=0,i&&(t=[0,i.value]),t[0]){case 0:case 1:i=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,a=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(i=c.trys,!(i=i.length>0&&i[i.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!i||t[1]>i[0]&&t[1]<i[3])){c.label=t[1];break}if(6===t[0]&&c.label<i[1]){c.label=i[1],i=t;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(t);break}i[2]&&c.ops.pop(),c.trys.pop();continue}t=r.call(e,c)}catch(e){t=[6,e],a=0}finally{o=i=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var o,a,i,s,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},l=function(e,r){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])},y=function(e){var r="function"==typeof Symbol&&e[Symbol.iterator],t=0;return r?r.call(e):{next:function(){return e&&t>=e.length&&(e=void 0),{value:e&&e[t++],done:!e}}}},m=function(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,o,a=t.call(e),i=[];try{for(;(void 0===r||r-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(t=a.return)&&t.call(a)}finally{if(o)throw o.error}}return i},w=function(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(m(arguments[r]));return e},A=function(e,r,t){function n(e){return function(r){return new Promise(function(t,n){y.push([e,r,t,n]),o()})}}function o(){!p&&y.length&&a((p=y.shift())[0],p[1])}function a(e,r){try{i(l[e](r))}catch(e){h(p[3],e)}}function i(e){e.done?h(p[2],e):"yield"===e.value[0]?h(p[2],{value:e.value[1],done:!1}):Promise.resolve(e.value[1]).then("delegate"===e.value[0]?s:c,u)}function s(e){i(e.done?e:{value:["yield",e.value],done:!1})}function c(e){a("next",e)}function u(e){a("throw",e)}function h(e,r){p=void 0,e(r),o()}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var p,f,l=t.apply(e,r||[]),y=[];return f={next:n("next"),throw:n("throw"),return:n("return")},f[Symbol.asyncIterator]=function(){return this},f},v=function(e){function r(r,t){return function(n){return{value:["delegate",(e[r]||t).call(e,n)],done:!1}}}var t={next:r("next"),throw:r("throw",function(e){throw e}),return:r("return",function(e){return{value:e,done:!0}})};return e=g(e),t[Symbol.iterator]=function(){return this},t},g=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=e[Symbol.asyncIterator];return r?r.call(e):"function"==typeof y?y(e):e[Symbol.iterator]()},e("__extends",a),e("__assign",i),e("__rest",s),e("__decorate",c),e("__param",u),e("__metadata",h),e("__awaiter",p),e("__generator",f),e("__exportStar",l),e("__values",y),e("__read",m),e("__spread",w),e("__asyncGenerator",A),e("__asyncDelegator",v),e("__asyncValues",g)})}).call(r,function(){return this}())},function(e,r){e.exports=require("crypto")}]);